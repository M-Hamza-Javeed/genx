<div id="page0" style="position:relative;width:612pt;height:792pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:95pt;left:461pt"><i><span style="font-family:BookAntiqua,serif;font-size:9pt">Appendix B</span></i></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:666pt;left:293pt"><b><span style="font-family:Arial,sans-serif;font-size:9pt">[</span></b><b><span style="font-family:Arial,sans-serif;font-size:8pt"> 143 </span></b><b><span style="font-family:Arial,sans-serif;font-size:9pt">]</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:115pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Now assume that the client side is asking for the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">templates.js</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> file that contains </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:127pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">the complete template content of the project. On the server side, we can write the </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:140pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">following code that will send the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">compiled.js</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> file content to the browser:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:161pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">// While templates.js file is loaded, it will </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:174pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">// send the compiled.js file&apos;s content</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:186pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">app.get(&apos;/templates.js&apos;, function (req, res) {</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:198pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  res</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:210pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">    .type(&apos;application/javascript&apos;)</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:223pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">    .send(fs.readFileSync(&apos;compiled.js&apos;, &apos;utf8&apos;));</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:235pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">});</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:254pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">So, a request to the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">template.js</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> file on the client side will display content similar to </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:267pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">the following code:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:288pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">var Templates = {</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:300pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  cachedTemplates: {}</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:313pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">};</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:337pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">Templates.cachedTemplates[&quot;userLogin&quot;] = function (obj) {</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:349pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  var __t, __p = &apos;&apos;,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:362pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">    __j = Array.prototype.join,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:374pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">    print = function () {</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:386pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">      __p += __j.call(arguments, &apos;&apos;);</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:398pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">    };</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:411pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  with(obj || {}) {</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:423pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">    __p += &apos;&lt;ul&gt;\r\n    &lt;li&gt;Username:\r\n        &lt;input type=&quot;text&quot; </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:434pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">value=&quot;&apos; +</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:446pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">      ((__t = (username)) == null ? &apos;&apos; : __t) +</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:458pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">      &apos;&quot; /&gt;\r\n    &lt;/li&gt;\r\n    &lt;li&gt;Password:\r\n        &lt;input </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:469pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">type=&quot;password&quot; value=&quot;&apos; +</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:481pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">      ((__t = (password)) == null ? &apos;&apos; : __t) +</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:493pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">      &apos;&quot; /&gt;\r\n    &lt;/li&gt;\r\n&lt;/ul&gt;\r\n&apos;;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:506pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  }</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:518pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  return __p;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:530pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">}</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:549pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">The final output is the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">TemplateManager</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> object with the template&apos;s filename as </span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:562pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">its property and the compiled version of the template as the value of that property. </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:575pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">This way, all of your template files will get added to the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">TemplateManager</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> object. </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:587pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">However, for this piece of code, </span><span style="font-family:BookAntiqua,serif;font-size:10.5pt">you need to make sure that each template&apos;s filename </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:600pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">is different. Otherwise, the template of the files with the same name will get </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:612pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">overwritten by another.</span></p>
</div>

<div id="page0" style="position:relative;width:612pt;height:792pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:95pt;left:468pt"><i><span style="font-family:BookAntiqua,serif;font-size:9pt">Chapter 4</span></i></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:666pt;left:295pt"><b><span style="font-family:Arial,sans-serif;font-size:9pt">[</span></b><b><span style="font-family:Arial,sans-serif;font-size:8pt"> 75 </span></b><b><span style="font-family:Arial,sans-serif;font-size:9pt">]</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:115pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">The </span><span style="font-family:CourierStd,serif;font-size:9.5pt">Backbone</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> collection provides a huge set of methods along with a number of </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:127pt;left:108pt"><span style="font-family:CourierStd,serif;font-size:9.5pt">Underscore</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> utility methods to work on it. Because a collection deals with multiple </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:140pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">data, you will find the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">Underscore</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> utility methods are very useful to operate on it. </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:153pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Discussing all these methods and their functionality is beyond the scope of this book, </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:165pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">but we are going to see how to use the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">fetch()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> and </span><span style="font-family:CourierStd,serif;font-size:9.5pt">save()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> methods to retrieve data </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:178pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">from and save data to the server using an AJAX request in the next section.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:209pt;left:108pt"><b><span style="font-family:Arial,sans-serif;font-size:18pt">Performing data operations with collections</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:231pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">You can use AJAX requests to save and fetch data to and from the server. The result </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:243pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">then needs to be applied on the collection. However, Backbone simplifies the complete </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:256pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">process by providing a few methods such as </span><span style="font-family:CourierStd,serif;font-size:9.5pt">fetch()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> and </span><span style="font-family:CourierStd,serif;font-size:9.5pt">save()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> to directly interact </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:269pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">with the server. We will use the same collection that we used in the previous section to </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:281pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">demonstrate how we can perform all data operations with collections.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:310pt;left:108pt"><b><span style="font-family:Arial,sans-serif;font-size:16pt">Fetching data from the server</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:330pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Fetching data from the server is quite easy. You just call the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">fetch()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> method on the </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:343pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">collection as shown in the following code line, and a </span><span style="font-family:CourierStd,serif;font-size:9.5pt">GET</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> request is sent to the URL </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:355pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">that we added in the collection&apos;s configuration. It receives a </span><span style="font-family:CourierStd,serif;font-size:9.5pt">JSON</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> array with objects </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:368pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">that get added to the collection as models.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:389pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">users.fetch();</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:409pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">On receiving the data, the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">set()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> method of the collection is automatically called </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:421pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">to update the collection. If a model doesn&apos;t exist, it gets added; if the model exists </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:434pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">already, the latest data gets merged with it; and if the collection has a model that  </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:446pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">is not there in the new data, it gets removed.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:475pt;left:108pt"><b><span style="font-family:Arial,sans-serif;font-size:16pt">Saving data to the server</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:496pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Unlike fetching data from the server, collections do not have a method to store data </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:508pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">as a whole to the server. Instead, the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">save()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> method of each individual model needs </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:521pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">to be called as shown in the following code snippet:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:542pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">var user = users.get(1);</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:554pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">user.save();</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:574pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">The </span><span style="font-family:CourierStd,serif;font-size:9.5pt">save()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> method appends the model&apos;s ID to the server&apos;s URL (</span><span style="font-family:CourierStd,serif;font-size:9.5pt">/users/1</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt">) and </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:586pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">sends a </span><span style="font-family:CourierStd,serif;font-size:9.5pt">PUT</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> request to that URL. So, to save the complete collection to the server,  </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:599pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">you need to iterate through the collection and call the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">save()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> method on each  </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:611pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">model individually.</span></p>
</div>

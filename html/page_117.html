<div id="page0" style="position:relative;width:540pt;height:648pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:32pt;left:225pt"><span style="font-family:Times,serif;font-size:9.963pt">Chapter 4. Modularity</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:100pt;left:81pt"><span style="font-family:Times,serif;font-size:9.963pt">&#x2022; If your header &#xfb01;les and interface declarations duplicate knowledge in your implementation code,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:112pt;left:86pt"><span style="font-family:Times,serif;font-size:9.963pt">is there a way you can generate the header &#xfb01;les and interface declarations from the code?</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:135pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">There is an analog of the SPOT rule for data structures: &#x201c;No junk, no confusion&#x201d;. &#x201c;No junk&#x201d; says</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:147pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">that the data structure (the model) should be minimal, e.g., not made so general that it can represent</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:159pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">situations which cannot exist. &#x201c;No confusion&#x201d; says that states which must be kept distinct in the</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:171pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">real-world problem must be kept distinct in the model. In short, the SPOT rule advocates seeking</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:183pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">a data structure whose states have a one-to-one correspondence with the states of the real-world</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:195pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">system to be modeled.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:217pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">From deeper within the Unix tradition, we can add some of our own corollaries of the SPOT rule:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:250pt;left:81pt"><span style="font-family:Times,serif;font-size:9.963pt">&#x2022; Are you duplicating data because you&#x2019;re caching intermediate results of some computation or</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:262pt;left:86pt"><span style="font-family:Times,serif;font-size:9.963pt">lookup? Consider carefully whether this is premature optimization; stale caches (and the layers</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:270pt;left:86pt"><span style="font-family:Times,serif;font-size:9.963pt">of code needed to keep caches synchronized) are a fertile source of bugs,</span><sup><span style="font-family:Times,serif;font-size:6.273pt">44</span></sup><sup><span style="font-family:Times,serif;font-size:9.963pt"> </span></sup><span style="font-family:Times,serif;font-size:9.963pt">and can even slow</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:286pt;left:86pt"><span style="font-family:Times,serif;font-size:9.963pt">down overall performance if (as often happens) the cache-management overhead is higher than</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:298pt;left:86pt"><span style="font-family:Times,serif;font-size:9.963pt">you expected.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:320pt;left:81pt"><span style="font-family:Times,serif;font-size:9.963pt">&#x2022; If you see lots of duplicative boilerplate code, can you generate all of it from a single higher-level</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:332pt;left:86pt"><span style="font-family:Times,serif;font-size:9.963pt">representation, twiddling a few knobs to generate the different cases?</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:355pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The reader should begin to see a pattern emerging here.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:377pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">In the Unix world, the SPOT Rule as a unifying idea has seldom been explicit &#x2014; but heavy use of</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:389pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">code generators to implement particular</span><i><span style="font-family:Times,serif;font-size:9.963pt"> kinds</span></i><span style="font-family:Times,serif;font-size:9.963pt"> of SPOT are very much part of the tradition.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:389pt;left:446pt"><span style="font-family:Times,serif;font-size:9.963pt">We&#x2019;ll</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:401pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">survey these techniques in Chapter 9.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:423pt;left:72pt"><b><span style="font-family:Helvetica,sans-serif;font-size:13.948pt">Compactness and the Strong Single Center</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:449pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">One subtle but powerful way to promote compactness in a design is to organize it around a strong</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:461pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">core algorithm addressing a clear formal de&#xfb01;nition of the problem, avoiding heuristics and fudging.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:483pt;left:108pt"><span style="font-family:Times,serif;font-size:9.963pt">Formalization often clari&#xfb01;es a task spectacularly.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:483pt;left:336pt"><span style="font-family:Times,serif;font-size:9.963pt">It is not enough for a</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:495pt;left:108pt"><span style="font-family:Times,serif;font-size:9.963pt">programmer to recognize that bits of his task fall within standard computer-</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:507pt;left:108pt"><span style="font-family:Times,serif;font-size:9.963pt">science categories &#x2014; a little depth-&#xfb01;rst search here and a quicksort there.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:507pt;left:416pt"><span style="font-family:Times,serif;font-size:9.963pt">The</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:526pt;left:72pt"><span style="font-family:Times,serif;font-size:5.018pt">44</span><span style="font-family:Times,serif;font-size:7.97pt">An archetypal example of bad caching is the</span><b><span style="font-family:Times,serif;font-size:7.97pt"> rehash</span></b><span style="font-family:Times,serif;font-size:7.97pt"> directive in csh(1); type</span><b><span style="font-family:Times,serif;font-size:7.97pt"> man 1 csh</span></b><span style="font-family:Times,serif;font-size:7.97pt"> for details. See the section called</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:536pt;left:72pt"><span style="font-family:Times,serif;font-size:7.97pt">&#x201c;Caching Operation Results&#x201d; for another example.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:262pt"><span style="font-family:Times,serif;font-size:9.963pt">116</span></p>
</div>

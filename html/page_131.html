<div id="page0" style="position:relative;width:612pt;height:792pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:95pt;left:468pt"><i><span style="font-family:BookAntiqua,serif;font-size:9pt">Chapter 7</span></i></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:666pt;left:293pt"><b><span style="font-family:Arial,sans-serif;font-size:9pt">[</span></b><b><span style="font-family:Arial,sans-serif;font-size:8pt"> 115 </span></b><b><span style="font-family:Arial,sans-serif;font-size:9pt">]</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:114pt;left:108pt"><b><span style="font-family:Arial,sans-serif;font-size:18pt">Organizing code with AMD</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:136pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">We will use RequireJS for our project. As discussed earlier, it comes with a bunch of </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:148pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">facilities such as the following:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:170pt;left:125pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">&#x2022; </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:170pt;left:143pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Adding a lot of script tags in one HTML file and managing all of the </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:182pt;left:143pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">dependencies on your own may work for a medium-level project, but will </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:195pt;left:143pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">gradually fail for a large-level project. Such a project may have thousands </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:207pt;left:143pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">of lines of code; managing a code base of that size requires small modules </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:220pt;left:143pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">to be defined in each individual file. With RequireJS, you do not need to </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:233pt;left:143pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">worry about how many files you have&#x2014;you just know that if the standard is </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:245pt;left:143pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">followed properly, it is bound to work.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:262pt;left:125pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">&#x2022; </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:262pt;left:143pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">The global namespace is never touched and you can freely give the best </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:275pt;left:143pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">names to something that matches with it the most.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:292pt;left:125pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">&#x2022; </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:292pt;left:143pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Debugging the RequireJS modules is a lot easier than other approaches </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:304pt;left:143pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">because you know what the dependencies and path to each of them are in </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:317pt;left:143pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">every module definition.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:334pt;left:125pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">&#x2022; </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:334pt;left:143pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">You can use </span><span style="font-family:CourierStd,serif;font-size:9.5pt">r.js</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt">, an optimization tool for RequireJS that minifies all the </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:346pt;left:144pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">JavaScript and CSS files, to create the production-ready build.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:377pt;left:108pt"><b><span style="font-family:Arial,sans-serif;font-size:18pt">Setting up an application</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:399pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">For a Backbone app, there must be a centralized object that will hold together all the </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:412pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">components of the application. In a simple application, most people generally just </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:424pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">make the main router work as the central object. But that will surely not work for a </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:437pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">large application and you need an </span><span style="font-family:CourierStd,serif;font-size:9.5pt">Application</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> object that should work as the parent </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:450pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">component. This object should have a method (mostly </span><span style="font-family:CourierStd,serif;font-size:9.5pt">init()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt">) that will work as the </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:462pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">entry point to your application and initialize the main router along with the Backbone </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:475pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">history. In addition, either your </span><span style="font-family:CourierStd,serif;font-size:9.5pt">Application</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> class should extend </span><span style="font-family:CourierStd,serif;font-size:9.5pt">Backbone.Events</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:487pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">or it should include a property that points to an instance of the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">Backbone.Events</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:500pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">class. The benefit of doing this is that the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">app</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> or </span><span style="font-family:CourierStd,serif;font-size:9.5pt">Backbone.Events</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> instance can act  </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:513pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">as a central event aggregator, and you can trigger application-level events on it.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:534pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">A very basic </span><span style="font-family:CourierStd,serif;font-size:9.5pt">Application</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> class will look like the following code snippet:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:555pt;left:125pt"><span style="font-family:CourierStd,serif;font-size:9pt">// File: application.js</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:580pt;left:125pt"><span style="font-family:CourierStd,serif;font-size:9pt">define([</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:592pt;left:125pt"><span style="font-family:CourierStd,serif;font-size:9pt">  &apos;underscore&apos;,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:604pt;left:125pt"><span style="font-family:CourierStd,serif;font-size:9pt">  &apos;backbone&apos;,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:617pt;left:125pt"><span style="font-family:CourierStd,serif;font-size:9pt">  &apos;router&apos;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:629pt;left:125pt"><span style="font-family:CourierStd,serif;font-size:9pt">], function (_, Backbone, Router) {</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:641pt;left:125pt"><span style="font-family:CourierStd,serif;font-size:9pt">  // the event aggregator</span></p>
</div>

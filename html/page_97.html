<div id="page0" style="position:relative;width:612pt;height:792pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:95pt;left:468pt"><i><span style="font-family:BookAntiqua,serif;font-size:9pt">Chapter 4</span></i></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:666pt;left:295pt"><b><span style="font-family:Arial,sans-serif;font-size:9pt">[</span></b><b><span style="font-family:Arial,sans-serif;font-size:8pt"> 81 </span></b><b><span style="font-family:Arial,sans-serif;font-size:9pt">]</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:115pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">    this.reset(this.where(criteria));</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:139pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">    // Mark this as filtered</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:152pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">    this._isFiltered = true;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:164pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  },</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:188pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  // Clear all filters applied to this collection</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:200pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  clearFilter: function () {</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:213pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">    // skip first reset event while the collection </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:225pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">    // has the original data</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:237pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">    if (this._isFiltered) {</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:249pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">      // Reset the collection with complete data set</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:262pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">      this.reset(this._totalData);</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:274pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">      this._isFiltered = false;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:286pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">    }</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:298pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  }</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:311pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">});</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:330pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">We create a custom </span><span style="font-family:CourierStd,serif;font-size:9.5pt">Collection</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> class that has a </span><span style="font-family:CourierStd,serif;font-size:9.5pt">_totalData</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> property, which is </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:342pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">supposed to hold the complete data of that collection. In the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">initialize</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> method,  </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:355pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">we check whether any data has been passed to the collection; if it has been passed, </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:368pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">we save that data in this variable. We also include an </span><span style="font-family:CourierStd,serif;font-size:9.5pt">add</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> event listener so that the </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:380pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">newly added data gets reflected.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:402pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Now, once you call the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">applyFilter()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> method on the collection, it first resets the </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:414pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">collection with full data and then applies the filter on this collection. That way, each </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:427pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">time you filter the collection with this method, you do not need to worry about </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:439pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">whether it is being applied to the previously filtered collection or not. Let&apos;s analyze </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:452pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">the functionality with a test case:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:473pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">var filteredCollection = new FilterCollection ([</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:486pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  { name: &apos;John&apos;, company: &apos;A&apos; }, </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:498pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  { name: &apos;Bill&apos;, company: &apos;B&apos; }, </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:510pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  { name: &apos;Rick&apos;, company: &apos;A&apos; }</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:522pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">]);</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:547pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">// Add another data to check whether add event is working or not</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:559pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">filteredCollection.add({</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:571pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  name: &apos;John&apos;,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:584pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  company: &apos;C&apos;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:596pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">});</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:620pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">// Filter with company</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:632pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">filteredCollection.applyFilter({</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:645pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  company: &apos;A&apos;</span></p>
</div>

<div id="page0" style="position:relative;width:540pt;height:648pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:32pt;left:209pt"><span style="font-family:Times,serif;font-size:9.963pt">Chapter 7. Multiprogramming</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:100pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Inexpensive process-spawning and easy process control are critical enablers for the Unix style of</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:112pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">programming. On an operating system such as VAX VMS, where starting processes is expensive</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:124pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">and slow and requires special privileges, one must build monster monoliths because one has no</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:136pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">choice. Fortunately the trend in the Unix family has been toward lower fork(2) overhead rather</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:148pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">than higher. Linux, in particular, is famously ef&#xfb01;cient this way, with a process-spawn faster than</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:160pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">thread-spawning on many other operating systems.</span><sup><span style="font-family:Times,serif;font-size:6.273pt">65</span></sup></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:181pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Historically, many Unix programmers have been encouraged to think in terms of multiple cooperat-</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:193pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">ing processes by experience with shell programming. Shell makes it relatively easy to set up groups</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:205pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">of multiple processes connected by pipes, running either in background or foreground or a mix of</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:217pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">the two.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:239pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">In the remainder of this chapter, we&#x2019;ll look at the implications of cheap process-spawning and</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:251pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">discuss how and when to apply pipes, sockets, and other interprocess communication (IPC) methods</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:263pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">to partition your design into cooperating processes. (In the next chapter, we&#x2019;ll apply the same</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:275pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">separation-of-functions philosophy to interface design.)</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:297pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">While the bene&#xfb01;t of breaking programs up into cooperating processes is a reduction in global</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:309pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">complexity, the cost is that we have to pay more attention to the design of the protocols which</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:321pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">are used to pass information and commands between processes. (In software systems of all kinds,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:333pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">bugs collect at interfaces.)</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:355pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">In Chapter 5 we looked at the lower level of this design problem &#x2014; how to lay out application</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:367pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">protocols that are transparent, &#xfb02;exible and extensible.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:367pt;left:301pt"><span style="font-family:Times,serif;font-size:9.963pt">But there is a second, higher level to the</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:379pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">problem which we blithely ignored. That is the problem of designing state machines for each side</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:391pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">of the communication.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:413pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">It is not hard to apply good style to the syntax of application protocols, given models like SMTP</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:425pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">or BEEP or XML-RPC. The real challenge is not protocol syntax but protocol</span><i><span style="font-family:Times,serif;font-size:9.963pt"> logic</span></i><span style="font-family:Times,serif;font-size:9.963pt">&#x2014;designing a</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:437pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">protocol that is both suf&#xfb01;ciently expressive and deadlock-free. Almost as importantly, the protocol</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:448pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">has to be</span><i><span style="font-family:Times,serif;font-size:9.963pt"> seen</span></i><span style="font-family:Times,serif;font-size:9.963pt"> to be expressive and deadlock-free; human beings attempting to model the behavior</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:460pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">of the communicating programs in their heads and verify its correctness must be able to do so.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:482pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">In our discussion, therefore, we will focus on the kinds of protocol logic one naturally uses with</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:494pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">each kind of interprocess communication.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:524pt;left:72pt"><span style="font-family:Times,serif;font-size:5.018pt">65</span><span style="font-family:Times,serif;font-size:7.97pt">See, for example, the results quoted in</span><i><span style="font-family:Times,serif;font-size:7.97pt"> Improving Context Switching Performance of Idle Tasks under Linux</span></i><span style="font-family:Times,serif;font-size:7.97pt"> [Appleton].</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:262pt"><span style="font-family:Times,serif;font-size:9.963pt">189</span></p>
</div>

<div id="page0" style="position:relative;width:612pt;height:792pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:221pt;left:144pt"><span style="font-family:ArialMT,sans-serif;font-size:30pt">Precompiling Templates on </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:257pt;left:297pt"><span style="font-family:ArialMT,sans-serif;font-size:30pt">the Server Side</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:309pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">In </span><i><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Chapter 2</span></i><span style="font-family:BookAntiqua,serif;font-size:10.5pt">, </span><i><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Working with Views</span></i><span style="font-family:BookAntiqua,serif;font-size:10.5pt">, we learned the advantages of using precompiled </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:321pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">templates in your application. In addition, we saw a number of options to store your </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:334pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">templates as inline in the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">index.html</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> file or as separate template files. We also saw </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:347pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">how we can use a template manager to precompile and cache templates to avoid </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:359pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">compilation overhead every time. However, this precompilation process will run </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:372pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">anyway when you start your application, which will surely take a certain period of </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:384pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">time. Wait! Aren&apos;t these templates static resources? Then the compiled versions of </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:397pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">the templates without data will also be static resources. Right? Then why not keep a </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:410pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">separate file with all of the precompiled templates ready and use it as soon as your </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:422pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">application starts? If you get a file with all of your templates already precompiled </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:435pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">and minified, it will certainly boost your application&apos;s performance. This is what </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:447pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">we will try here&#x2014;we will develop a script to precompile the templates on the </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:460pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">server side, which will traverse all of the template files and create a single template </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:473pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">manager file. We use Node.js here, but you can use any server-side technology to get </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:485pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">the same result. The complete working code is given in our code samples.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:506pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">To precompile, we need a template engine with precompilation support. We will  </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:519pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">use Underscore.js here, but you are free to use your desired template engine to </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:532pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">achieve the result. The following Node.js example shows you how to achieve  </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:544pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">this functionality:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:566pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">// load the file system node module</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:578pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">var fs = require(&apos;fs&apos;),</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:590pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  // load the underscore.js</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:602pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  _ = require(&apos;../../../lib/underscore.js&apos;);</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:627pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">var templateDir = &apos;./templates/&apos;,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:639pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  template,</span></p>
</div>

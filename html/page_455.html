<div id="page0" style="position:relative;width:540pt;height:648pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:32pt;left:224pt"><span style="font-family:Times,serif;font-size:9.963pt">Chapter 17. Portability</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:100pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">If you must have system &#xfb01;le locations in your code, your best alternative depends on whether</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:112pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">you will be distributing in source code or binary form.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:112pt;left:316pt"><span style="font-family:Times,serif;font-size:9.963pt">If you are distributing in source, the</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:124pt;left:72pt"><i><span style="font-family:Times,serif;font-size:9.963pt">autoconf</span></i><span style="font-family:Times,serif;font-size:9.963pt"> tools we discuss in the next section will help you.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:124pt;left:322pt"><span style="font-family:Times,serif;font-size:9.963pt">If you&#x2019;re distributing in binary, then</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:136pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">it&#x2019;s good practice to have your program poke around at runtime and see if it can automatically</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:148pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">adapt itself to local conditions &#x2014; say, by actually checking for the existence of</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> /var/mail</span></tt><span style="font-family:Times,serif;font-size:9.963pt"> and</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:160pt;left:72pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">/var/spool/mail</span></tt><span style="font-family:Times,serif;font-size:9.963pt">.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:182pt;left:72pt"><b><span style="font-family:Helvetica,sans-serif;font-size:13.948pt">Tools for Portability</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:208pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">You can often use the open-source GNU autoconf(1) we surveyed in Chapter 15 to handle portability</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:220pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">issues, do system-con&#xfb01;guration probes, and tailor your make&#xfb01;les.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:220pt;left:348pt"><span style="font-family:Times,serif;font-size:9.963pt">People building from sources</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:232pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">today expect to be able to type</span><b><span style="font-family:Times,serif;font-size:9.963pt"> con&#xfb01;gure; make; make install</span></b><span style="font-family:Times,serif;font-size:9.963pt"> and get a clean build.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:232pt;left:427pt"><span style="font-family:Times,serif;font-size:9.963pt">There is a</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:244pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">good tutorial on these tools [http://seul.org/docs/autotut/]. Even if you&#x2019;re distributing in binary, the</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:256pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">autoconf(1) tools can help automate away the problem of conditionalizing your code for different</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:268pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">platforms.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:290pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">Other tools that address this problem; two of the better known are the Imake(1) tool associated with</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:302pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">the X windowing system and the</span><i><span style="font-family:Times,serif;font-size:9.963pt"> Con&#xfb01;gure</span></i><span style="font-family:Times,serif;font-size:9.963pt"> tool built by Larry Wall (later the inventor of Perl) and</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:314pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">adapted for many different projects.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:314pt;left:226pt"><span style="font-family:Times,serif;font-size:9.963pt">All are at least as complicated as the autoconf suite, and no</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:326pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">longer as often used. They don&#x2019;t cover as wide a range of target systems.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:348pt;left:71pt"><b><span style="font-family:Helvetica,sans-serif;font-size:15.94pt">Internationalization</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:377pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">An in-depth discussion of code internationalization &#x2014; designing software so the interface readily</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:389pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">incorporates multiple languages and the vagaries of different character sets &#x2014; would be out of scope</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:401pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">for this book. However, a few lessons for good practice do stand out from Unix experience.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:423pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">First,</span><i><span style="font-family:Times,serif;font-size:9.963pt"> separate the message base from the code</span></i><span style="font-family:Times,serif;font-size:9.963pt">.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:423pt;left:277pt"><span style="font-family:Times,serif;font-size:9.963pt">Good Unix practice is to separate the message</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:435pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">strings a program uses from its code. so that message dictionaries in other languages can be plugged</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:446pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">in without modifying the code.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:468pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">The best-known tool for this job is GNU</span><i><span style="font-family:Times,serif;font-size:9.963pt"> gettext</span></i><span style="font-family:Times,serif;font-size:9.963pt">, which requires that you wrap native-language</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:480pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">strings that need to be internationalized in a special macro.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:480pt;left:321pt"><span style="font-family:Times,serif;font-size:9.963pt">The macro uses each string as a key</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:492pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">into per-language dictionaries which can be supplied as separate &#xfb01;les.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:492pt;left:362pt"><span style="font-family:Times,serif;font-size:9.963pt">If no such dictionaries are</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:504pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">available (or if they are but the string lookup does not return a match), the macro simply returns its</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:516pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">argument, implicitly falling back on the native language in the code.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:262pt"><span style="font-family:Times,serif;font-size:9.963pt">454</span></p>
</div>

<div id="page0" style="position:relative;width:540pt;height:648pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:32pt;left:209pt"><span style="font-family:Times,serif;font-size:9.963pt">Chapter 7. Multiprogramming</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:100pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">simple utilities can be combined to support creating and manipulating relational databases expressed</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:112pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">as simple textual tables.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:134pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The major weakness of pipes is that they are unidirectional.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:134pt;left:338pt"><span style="font-family:Times,serif;font-size:9.963pt">It&#x2019;s not possible for a pipeline</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:146pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">component to pass control information back up the pipe other than by terminating (in which case the</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:157pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">previous stage will get a</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> SIGPIPE</span></tt><span style="font-family:Times,serif;font-size:9.963pt"> signal on the next write). Accordingly, the protocol for passing</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:169pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">data is simply the receiver&#x2019;s input format.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:191pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">So far, we have discussed anonymous pipes created by the shell. There is a variant called a</span><i><span style="font-family:Times,serif;font-size:9.963pt"> named</span></i></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:203pt;left:72pt"><i><span style="font-family:Times,serif;font-size:9.963pt">pipe</span></i><span style="font-family:Times,serif;font-size:9.963pt"> which is a special kind of &#xfb01;le. If two programs open the &#xfb01;le, one for reading and the other for</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:215pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">writing, a named pipe acts like a pipe-&#xfb01;tting between them. Named pipes are a bit of a historical</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:227pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">relic; they have been largely displaced from use by named</span><i><span style="font-family:Times,serif;font-size:9.963pt"> sockets</span></i><span style="font-family:Times,serif;font-size:9.963pt">, which we&#x2019;ll discuss below. (For</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:239pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">more on the history of this relic, see the discussion of System V IPC below.)</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:261pt;left:72pt"><b><span style="font-family:Helvetica,sans-serif;font-size:11.955pt">Case Study: Piping to a Pager</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:285pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Pipelines have many uses. For one example, Unix&#x2019;s process lister ps(1) lists processes to standard</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:297pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">output without caring that a long listing might scroll off the top of the user&#x2019;s display too quickly</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:309pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">for the user to see it.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:309pt;left:170pt"><span style="font-family:Times,serif;font-size:9.963pt">Unix has another program, more(1), which displays its standard input in</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:321pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">screen-sized chunks, prompting for a user keystroke after displaying each screenful.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:343pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Thus, if the user types &#x201c;</span><b><span style="font-family:Times,serif;font-size:9.963pt">ps | more</span></b><span style="font-family:Times,serif;font-size:9.963pt">&#x201d;, piping the output of ps(1) to the input of more(1), successive</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:355pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">page-sized pieces of the list of processes will be displayed after each keystroke.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:377pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The ability to combine programs like this can be extremely useful. But the real win here is not cute</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:389pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">combinations; it&#x2019;s that because both pipes and more(1) exist,</span><i><span style="font-family:Times,serif;font-size:9.963pt"> other programs can be simpler</span></i><span style="font-family:Times,serif;font-size:9.963pt">. Pipes</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:401pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">mean that programs like ls(1) (and other programs that write to standard out) don&#x2019;t have to grow</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:413pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">their own pagers &#x2014; and we&#x2019;re saved from a world of a thousand built-in pagers (each, naturally,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:425pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">with its own divergent look and feel). Code bloat is avoided and global complexity reduced.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:446pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">As a bonus, if anyone needs to customize pager behavior, it can be done in</span><i><span style="font-family:Times,serif;font-size:9.963pt"> one</span></i><span style="font-family:Times,serif;font-size:9.963pt"> place, by changing</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:458pt;left:72pt"><i><span style="font-family:Times,serif;font-size:9.963pt">one</span></i><span style="font-family:Times,serif;font-size:9.963pt"> program.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:458pt;left:134pt"><span style="font-family:Times,serif;font-size:9.963pt">Indeed, multiple pagers can exist, and will all be useful with every application that</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:470pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">writes to standard output.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:492pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">In fact, this has actually happened. On modern Unixes, more(1) has been largely replaced by less(1),</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:500pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">which adds the capability to scroll back in the displayed &#xfb01;le rather than just forward.</span><sup><span style="font-family:Times,serif;font-size:6.273pt">70</span></sup><sup><span style="font-family:Times,serif;font-size:9.963pt"> </span></sup><span style="font-family:Times,serif;font-size:9.963pt">Because</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:516pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">less(1) is decoupled from the programs that use it, it&#x2019;s possible to simply alias &#x2018;more&#x2019; to &#x2018;less&#x2019; in</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:536pt;left:72pt"><span style="font-family:Times,serif;font-size:5.018pt">70</span><span style="font-family:Times,serif;font-size:7.97pt">The less(1) man page explains the name by observing &#x201c;Less is more&#x201d;.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:262pt"><span style="font-family:Times,serif;font-size:9.963pt">194</span></p>
</div>

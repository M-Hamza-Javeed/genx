<div id="page0" style="position:relative;width:612pt;height:792pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:95pt;left:108pt"><i><span style="font-family:BookAntiqua,serif;font-size:9pt">Working with Views</span></i></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:666pt;left:295pt"><b><span style="font-family:Arial,sans-serif;font-size:9pt">[</span></b><b><span style="font-family:Arial,sans-serif;font-size:8pt"> 36 </span></b><b><span style="font-family:Arial,sans-serif;font-size:9pt">]</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:115pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">In order to prevent these memory leaks, we should always keep track of the child </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:127pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">views while removing parent views. For instance, in the previous section we saw </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:140pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">how we can store the child views inside a </span><span style="font-family:CourierStd,serif;font-size:9.5pt">this.subViews</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> array. We can override the </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:153pt;left:108pt"><span style="font-family:CourierStd,serif;font-size:9.5pt">remove()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> method in the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">Company</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> view class and destroy the subviews individually </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:165pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">before removing the main view:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:187pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">var Company = Backbone.View.extend({</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:199pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  ...</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:211pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  remove: function () {</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:223pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">    _(this.subViews).each(function (view) {</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:236pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">      this.stopeListening(view);</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:248pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">      view.remove();</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:260pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">    }, this);</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:285pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">    Backbone.View.prototype.remove.call(this, arguments);</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:297pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  }</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:309pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">});</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:328pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">This will ensure that all your child views are removed before the parent view. So, in </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:341pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">order to get rid of memory leak issues, keep a few points in mind:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:362pt;left:125pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">&#x2022; </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:362pt;left:143pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Always have a reference to the current top level view</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:379pt;left:125pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">&#x2022; </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:379pt;left:143pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Keep references of all the child views inside a parent view</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:396pt;left:125pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">&#x2022; </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:396pt;left:143pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Ensure every event gets unbound</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:417pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Also, if you are using any Backbone.js version older than V9.9.0, calling only the </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:430pt;left:108pt"><span style="font-family:CourierStd,serif;font-size:9.5pt">remove()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> method will not clean up the events, and you will have to unbind them </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:442pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">explicitly. The same works for the events that you register using the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">on()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> method </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:455pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">instead of the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">listenTo()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> method. For older versions of Backbone, you may need to </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:468pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">use something like the following code:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:489pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">remove: function () {&#xa0;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:500pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  this.unbind(); // Unbind all local event bindings</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:511pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:521pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  // Unbind reference all such items</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:532pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  this.model.unbind(&apos;change&apos;, this.render, this);  </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:554pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  // Remove this view</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:565pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  Backbone.View.prototype.remove.call(this, arguments);</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:586pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  // Delete the jQuery wrapped object variable</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:597pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  delete this.$el;  </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:608pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:619pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  // Delete the variable reference to this node</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:629pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  delete this.el; </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:640pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">}</span></p>
</div>

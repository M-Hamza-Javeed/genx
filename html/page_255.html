<div id="page0" style="position:relative;width:540pt;height:648pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:32pt;left:225pt"><span style="font-family:Times,serif;font-size:9.963pt">Chapter 9. Generation</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:102pt;left:98pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">user esr there is esr here</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:113pt;left:117pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">options fetchall dropstatus warnings 3600</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:134pt;left:72pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">poll imap.netaxs.com with proto IMAP</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:145pt;left:98pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">user &quot;esr&quot; there is esr here options dropstatus warnings 3600</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:175pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The design objective of</span><i><span style="font-family:Times,serif;font-size:9.963pt"> fetchmailconf</span></i><span style="font-family:Times,serif;font-size:9.963pt"> was to completely hide the control &#xfb01;le syntax behind a</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:187pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">fashionable, ergonomically-correct GUI replete with selection buttons, slider bars and &#xfb01;ll-out forms.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:199pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">But the beta design had a problem: it could easily generate con&#xfb01;guration &#xfb01;les from the user&#x2019;s GUI</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:211pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">actions, but could not read and edit existing ones.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:232pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The parser for</span><i><span style="font-family:Times,serif;font-size:9.963pt"> fetchmail</span></i><span style="font-family:Times,serif;font-size:9.963pt">&#x2019;s con&#xfb01;guration &#xfb01;le syntax is rather elaborate. It&#x2019;s actually written in</span><i><span style="font-family:Times,serif;font-size:9.963pt"> yacc</span></i></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:244pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">and</span><i><span style="font-family:Times,serif;font-size:9.963pt"> lex</span></i><span style="font-family:Times,serif;font-size:9.963pt">, the two classic Unix tools for generating language-parsing code in C. For</span><i><span style="font-family:Times,serif;font-size:9.963pt"> fetchmailconf</span></i><span style="font-family:Times,serif;font-size:9.963pt"> to</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:256pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">be able to edit existing con&#xfb01;guration &#xfb01;les, it at &#xfb01;rst appeared that it would be necessary to replicate</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:268pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">that elaborate parser in fetchmailconf&#x2019;s implementation language &#x2014; Python.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:290pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">This tactic seemed doomed.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:290pt;left:200pt"><span style="font-family:Times,serif;font-size:9.963pt">Even leaving aside the amount of duplicative work implied, it is</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:302pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">notoriously hard to be certain that two parsers in two different languages accept the same grammar.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:314pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Keeping them synchronized as the con&#xfb01;guration language evolved bid fair to be a maintenance</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:326pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">nightmare. It would have violated the SPOT rule we discussed in Chapter 4 wholesale.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:347pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">This problem stumped me for a while. The insight that cracked it was that</span><i><span style="font-family:Times,serif;font-size:9.963pt"> fetchmailconf</span></i><span style="font-family:Times,serif;font-size:9.963pt"> could use</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:359pt;left:72pt"><i><span style="font-family:Times,serif;font-size:9.963pt">fetchmail</span></i><span style="font-family:Times,serif;font-size:9.963pt">&#x2019;s own parser as a &#xfb01;lter!</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:359pt;left:214pt"><span style="font-family:Times,serif;font-size:9.963pt">I added a</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> --configdump</span></tt><span style="font-family:Times,serif;font-size:9.963pt"> option to</span><i><span style="font-family:Times,serif;font-size:9.963pt"> fetchmail</span></i><span style="font-family:Times,serif;font-size:9.963pt"> that would parse</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:371pt;left:71pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">.fetchmailrc</span></tt><span style="font-family:Times,serif;font-size:9.963pt"> and dump the result to standard output in the format of a Python initializer.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:371pt;left:454pt"><span style="font-family:Times,serif;font-size:9.963pt">For</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:383pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">the &#xfb01;le above, the result would look roughly like Example 9.2 (to save space, some data not relevant</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:395pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">to the example is omitted).</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:417pt;left:71pt"><b><span style="font-family:Times,serif;font-size:11.955pt">Example 9.2. Python structure dump of a</span></b><b><i><span style="font-family:Times,serif;font-size:11.955pt"> fetchmail</span></i></b><b><span style="font-family:Times,serif;font-size:11.955pt"> con&#xfb01;guration.</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:452pt;left:71pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">fetchmailrc = {</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:463pt;left:87pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">&#x2019;poll_interval&#x2019;:300,</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:474pt;left:87pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">&quot;logfile&quot;:None,</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:485pt;left:87pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">&quot;postmaster&quot;:&quot;esr&quot;,</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:495pt;left:87pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">&#x2019;bouncemail&#x2019;:TRUE,</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:506pt;left:87pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">&quot;properties&quot;:None,</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:517pt;left:87pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">&#x2019;invisible&#x2019;:FALSE,</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:528pt;left:87pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">&#x2019;syslog&#x2019;:FALSE,</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:538pt;left:87pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt"># List of server entries begins here</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:262pt"><span style="font-family:Times,serif;font-size:9.963pt">254</span></p>
</div>

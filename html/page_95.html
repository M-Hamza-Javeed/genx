<div id="page0" style="position:relative;width:612pt;height:792pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:95pt;left:468pt"><i><span style="font-family:BookAntiqua,serif;font-size:9pt">Chapter 4</span></i></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:666pt;left:295pt"><b><span style="font-family:Arial,sans-serif;font-size:9pt">[</span></b><b><span style="font-family:Arial,sans-serif;font-size:8pt"> 79 </span></b><b><span style="font-family:Arial,sans-serif;font-size:9pt">]</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:115pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">users.reset(filteredData);</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:139pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">// A collection with only filtered data</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:152pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">console.log(users);</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:171pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Now, if you re-render the list, it will only show the filtered data. This looks fine; </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:183pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">however, if you want to re-filter the collection, it will not be applied on the complete </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:196pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">collection of data but on the previously filtered data. This is wrong; it is advisable to </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:209pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">avoid such patterns that may lead to severe problems in a later stage. When you filter </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:221pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">a collection only once, there should not be any problem, but multiple filtering of the </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:234pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">collection will surely cause problems if the same collection is used elsewhere too. The </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:246pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">following code, for example, will return zero results for the same reason:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:268pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">users.where({</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:280pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  company: &apos;B&apos;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:292pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">});</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:312pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Let&apos;s attempt a few options to find a solution to this problem. We will first try this </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:324pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">using a duplicate collection.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:355pt;left:108pt"><b><span style="font-family:Arial,sans-serif;font-size:18pt">Filtering a collection with a duplicate </span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:377pt;left:108pt"><b><span style="font-family:Arial,sans-serif;font-size:18pt">collection</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:399pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">There are multiple solutions to the problem we found in the preceding section. For </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:411pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">example, we can create another collection instance whenever a collection is filtered </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:424pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">and we always reset this second collection with the filtered data. That way, the main </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:436pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">collection will not be altered and passing the second collection to the view instance </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:449pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">will produce the desired result.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:470pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">var filteredData = users.where({</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:483pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  company: &apos;A&apos;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:495pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">});</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:519pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">// Create a new collection that will only hold filtered data</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:532pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">var filteredCollection = new Backbone.Collection();</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:556pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">// Reset this collection every time </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:568pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">// there is a new set of filtered data</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">filteredCollection.reset(filteredData);</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:605pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">console.log(filteredCollection, users);</span></p>
</div>

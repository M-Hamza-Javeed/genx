<div id="page0" style="position:relative;width:540pt;height:648pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:32pt;left:234pt"><span style="font-family:Times,serif;font-size:9.963pt">Chapter 15. Tools</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:100pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Most importantly, the</span><i><span style="font-family:Times,serif;font-size:9.963pt"> lex</span></i><span style="font-family:Times,serif;font-size:9.963pt"> speci&#xfb01;cation minilanguage is much higher-level and more compact than</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:112pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">equivalent handcrafted C. Modules are available to use</span><i><span style="font-family:Times,serif;font-size:9.963pt"> &#xfb02;ex</span></i><span style="font-family:Times,serif;font-size:9.963pt">, the open-source version, with Perl (&#xfb01;nd</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:124pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">them with a Web search for &#x201c;lex perl&#x201d;), and a work-alike implementation is part of</span><i><span style="font-family:Times,serif;font-size:9.963pt"> PLY</span></i><span style="font-family:Times,serif;font-size:9.963pt"> in Python.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:146pt;left:72pt"><i><span style="font-family:Times,serif;font-size:9.963pt">lex</span></i><span style="font-family:Times,serif;font-size:9.963pt"> generates parsers that are up to an order of magnitude slower than hand-coded parsers. This is</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:158pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">not a good reason to hand-code, however; it&#x2019;s an argument for prototyping with</span><i><span style="font-family:Times,serif;font-size:9.963pt"> lex</span></i><span style="font-family:Times,serif;font-size:9.963pt"> and hand-hacking</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:170pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">only if prototyping reveals an actual bottleneck.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:191pt;left:72pt"><i><span style="font-family:Times,serif;font-size:9.963pt">yacc</span></i><span style="font-family:Times,serif;font-size:9.963pt"> is a parser generator. It, too, was written to automate part of the job of writing compilers. It</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:203pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">takes as input a grammar speci&#xfb01;cation in a declarative minilanguage resembling BNF (Backus-Naur</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:215pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Form) with C code associated with each element of the grammar.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:215pt;left:349pt"><span style="font-family:Times,serif;font-size:9.963pt">It generates code for a parser</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:227pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">function that, when called, accepts text matching the grammar from an input stream.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:227pt;left:435pt"><span style="font-family:Times,serif;font-size:9.963pt">As each</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:239pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">grammar element is recognized, the parser function runs the associated C code.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:261pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The combination of</span><i><span style="font-family:Times,serif;font-size:9.963pt"> lex</span></i><span style="font-family:Times,serif;font-size:9.963pt"> and</span><i><span style="font-family:Times,serif;font-size:9.963pt"> yacc</span></i><span style="font-family:Times,serif;font-size:9.963pt"> is very effective for writing language interpreters of all kinds.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:273pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Though most Unix programmers never get to do the kind of general-purpose compiler-building that</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:285pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">these tools were meant to assist, they&#x2019;re extremely useful for writing parsers for run-control &#xfb01;le</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:297pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">syntaxes and domain-speci&#xfb01;c minilanguages.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:319pt;left:72pt"><i><span style="font-family:Times,serif;font-size:9.963pt">lex</span></i><span style="font-family:Times,serif;font-size:9.963pt">-generated tokenizers are very fast at recognizing low-level patterns in input streams, but the</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:331pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">regular-expression minilanguage that</span><i><span style="font-family:Times,serif;font-size:9.963pt"> lex</span></i><span style="font-family:Times,serif;font-size:9.963pt"> knows is not good at counting things, or recognizing</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:343pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">recursively nested structures.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:343pt;left:199pt"><span style="font-family:Times,serif;font-size:9.963pt">For parsing those, you want</span><i><span style="font-family:Times,serif;font-size:9.963pt"> yacc</span></i><span style="font-family:Times,serif;font-size:9.963pt">.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:343pt;left:347pt"><span style="font-family:Times,serif;font-size:9.963pt">On the other hand, while you</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:355pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">theoretically could write a</span><i><span style="font-family:Times,serif;font-size:9.963pt"> yacc</span></i><span style="font-family:Times,serif;font-size:9.963pt"> grammar to do its own token-gathering, the grammar to specify that</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:367pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">would be hugely bloated and the parser extremely slow. For tokenizing input, you want</span><i><span style="font-family:Times,serif;font-size:9.963pt"> lex</span></i><span style="font-family:Times,serif;font-size:9.963pt">. Thus,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:379pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">these tools are symbiotic.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:401pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">If you can implement your parser in a higher-level language than C (which we recommend you do;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:413pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">see Chapter 14 for discussion), then look for equivalent facilities like Python&#x2019;s PLY (which covers</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:421pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">both</span><i><span style="font-family:Times,serif;font-size:9.963pt"> lex</span></i><span style="font-family:Times,serif;font-size:9.963pt"> and</span><i><span style="font-family:Times,serif;font-size:9.963pt"> yacc</span></i><span style="font-family:Times,serif;font-size:9.963pt">)</span><sup><span style="font-family:Times,serif;font-size:6.273pt">131</span></sup><sup><span style="font-family:Times,serif;font-size:9.963pt"> </span></sup><span style="font-family:Times,serif;font-size:9.963pt">or Perl&#x2019;s PY and Parse::Yapp modules, or Java&#x2019;s CUP,</span><sup><span style="font-family:Times,serif;font-size:6.273pt">132</span></sup><sup><span style="font-family:Times,serif;font-size:9.963pt"> </span></sup><span style="font-family:Times,serif;font-size:9.963pt">Jack,</span><sup><span style="font-family:Times,serif;font-size:6.273pt">133</span></sup><sup><span style="font-family:Times,serif;font-size:9.963pt"> </span></sup><span style="font-family:Times,serif;font-size:9.963pt">or Yacc/M</span><sup><span style="font-family:Times,serif;font-size:6.273pt">134</span></sup></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:437pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">packages.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:458pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">As with macro processors, one of the problems with code generators and preprocessors is that</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:470pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">compile-time errors in the generated code may carry line numbers that are relative to the generated</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:482pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">code (which you don&#x2019;t want to edit) rather than the generator input (which is where you need to</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:502pt;left:72pt"><span style="font-family:Times,serif;font-size:5.018pt">131</span><span style="font-family:Times,serif;font-size:7.97pt">PLY is downloadable [http://systems.cs.uchicago.edu/ply/].</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:511pt;left:72pt"><span style="font-family:Times,serif;font-size:5.018pt">132</span><span style="font-family:Times,serif;font-size:7.97pt">CUP is downloadable [http://www.cs.princeton.edu/~appel/modern/java/CUP/].</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:520pt;left:72pt"><span style="font-family:Times,serif;font-size:5.018pt">133</span><span style="font-family:Times,serif;font-size:7.97pt">Jack is downloadable [http://www.javaworld.com/javaworld/jw-12-1996/jw-12-jack.html].</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:529pt;left:72pt"><span style="font-family:Times,serif;font-size:5.018pt">134</span><span style="font-family:Times,serif;font-size:7.97pt">Yacc/M is downloadable [http://david.tribble.com/yaccm.html].</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:262pt"><span style="font-family:Times,serif;font-size:9.963pt">394</span></p>
</div>

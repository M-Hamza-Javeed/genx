<div id="page0" style="position:relative;width:540pt;height:648pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:32pt;left:225pt"><span style="font-family:Times,serif;font-size:9.963pt">Chapter 9. Generation</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:100pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">write duplicative glue code in accordance with the SPOT rule&#x2014;I might have rushed into coding</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:112pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">a parser in Python.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:112pt;left:159pt"><span style="font-family:Times,serif;font-size:9.963pt">The &#xfb01;rst key insight that</span><i><span style="font-family:Times,serif;font-size:9.963pt"> fetchmail</span></i><span style="font-family:Times,serif;font-size:9.963pt"> itself could be made into</span><i><span style="font-family:Times,serif;font-size:9.963pt"> fetchmailconf</span></i><span style="font-family:Times,serif;font-size:9.963pt">&#x2019;s</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:124pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">con&#xfb01;guration parser might never have happened.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:146pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">The second insight (that</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> copy_instance</span></tt><span style="font-family:Times,serif;font-size:9.963pt"> could be generic) proceeded from the Unix tradition of</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:158pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">looking assiduously for ways to avoid hand-hacking. But more speci&#xfb01;cally, Unix programmers are</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:170pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">very used to writing parser speci&#xfb01;cations to generate parsers for processing language-like markups;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:181pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">from there it was a short step to believing that the rest of the job could be done by some kind of</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:193pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">generic tree-walk of the con&#xfb01;guration structure. Two separate stages of data-driven programming,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:205pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">one building on the other, were needed to solve the design problem cleanly.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:227pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">Insights like this can be extraordinarily powerful.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:227pt;left:279pt"><span style="font-family:Times,serif;font-size:9.963pt">The code we have been looking at was written</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:239pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">in about ninety minutes, worked the &#xfb01;rst time it was run, and has been stable in the years since (the</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:251pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">only time it has ever broken is when it threw an exception in the presence of genuine version skew).</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:263pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">It&#x2019;s less than forty lines and beautifully simple. There is no way that the na&#xef;ve approach of building</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:275pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">an entire second parser could possibly have produced this kind of maintainability, reliability or</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:287pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">compactness. Reuse, simpli&#xfb01;cation, generalization, orthogonality: this is the Zen of Unix in action.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:309pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">In Chapter 10, we&#x2019;ll examine the run-control syntax of</span><i><span style="font-family:Times,serif;font-size:9.963pt"> fetchmail</span></i><span style="font-family:Times,serif;font-size:9.963pt"> as an example of the standard</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:321pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">shell-like metaformat for run-control &#xfb01;les. In Chapter 14 we&#x2019;ll use</span><i><span style="font-family:Times,serif;font-size:9.963pt"> fetchmailconf</span></i><span style="font-family:Times,serif;font-size:9.963pt"> as an example of</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:333pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">Python&#x2019;s strength in rapidly building GUIs.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:355pt;left:71pt"><b><span style="font-family:Helvetica,sans-serif;font-size:15.94pt">Ad-hoc Code Generation</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:384pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">Unix comes equipped with some powerful special-purpose code generators for purposes like</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:396pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">building lexical analyzers (tokenizers) and parsers; we&#x2019;ll survey these in Chapter 15.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:396pt;left:430pt"><span style="font-family:Times,serif;font-size:9.963pt">But there</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:408pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">are much simpler, lighter-weight sorts of code generation we can use to make life easier without</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:420pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">having to know any compiler theory or write (error-prone) procedural logic.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:442pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">Here are a couple of simple case studies to illustrate this point:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:464pt;left:71pt"><b><span style="font-family:Helvetica,sans-serif;font-size:13.948pt">Case Study: Generating Code for the</span></b><b><i><span style="font-family:Helvetica,sans-serif;font-size:13.948pt"> ascii</span></i></b><b><span style="font-family:Helvetica,sans-serif;font-size:13.948pt"> Displays</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:490pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">Called without arguments,</span><i><span style="font-family:Times,serif;font-size:9.963pt"> ascii</span></i><span style="font-family:Times,serif;font-size:9.963pt"> generates a usage screen that looks like Example 9.5.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:262pt"><span style="font-family:Times,serif;font-size:9.963pt">259</span></p>
</div>

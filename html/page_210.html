<div id="page0" style="position:relative;width:540pt;height:648pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:32pt;left:209pt"><span style="font-family:Times,serif;font-size:9.963pt">Chapter 7. Multiprogramming</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:97pt;left:72pt"><b><span style="font-family:Helvetica,sans-serif;font-size:11.955pt">System V IPC</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:122pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The System V IPC facilities are message-passing facilities based on the System V shared memory</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:134pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">facility we described earlier.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:156pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Programs that cooperate using System V IPC usually de&#xfb01;ne shared protocols based on exchanging</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:168pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">short (up to 8K) binary messages. The relevant manual pages are msgctl(2) and friends. As this style</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:179pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">has been largely superseded by text protocols passed between sockets, we do not give an example</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:191pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">here.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:213pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The System V IPC facilities are present in Linux and other modern Unixes. However, as they are a</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:225pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">legacy feature, they are not exercised very often. The Linux version is still known to have bugs as</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:237pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">of mid-2003. Nobody seems to care enough to &#xfb01;x them.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:259pt;left:72pt"><b><span style="font-family:Helvetica,sans-serif;font-size:11.955pt">Streams</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:283pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Streams networking was invented for Unix Version 8 (1985) by Dennis Ritchie. A re-implementation</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:295pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">called STREAMS (yes, it is all-capitals in the documentation) &#xfb01;rst became available in the 3.0</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:307pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">release of System V Unix (1986).</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:307pt;left:233pt"><span style="font-family:Times,serif;font-size:9.963pt">The STREAMS facility provided a full-duplex interface</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:319pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">(functionally not unlike a BSD socket, and like sockets, accessible through normal read(2) and</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:331pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">write(2) operations after initial setup) between a user process and a speci&#xfb01;ed device driver in the</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:343pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">kernel.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:343pt;left:111pt"><span style="font-family:Times,serif;font-size:9.963pt">The device driver might be hardware such as a serial or network card, or it might be a</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:355pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">software-only pseudodevice set up to pass data between user processes.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:373pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">An interesting feature of both streams and STREAMS</span><sup><span style="font-family:Times,serif;font-size:6.273pt">76</span></sup><sup><span style="font-family:Times,serif;font-size:9.963pt"> </span></sup><span style="font-family:Times,serif;font-size:9.963pt">is that it is possible to push protocol-</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:389pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">translation modules into the kernel&#x2019;s processing path, so that the device the user process &#x2018;sees&#x2019;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:401pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">through the full-duplex channel is actually &#xfb01;ltered. This capability could be used, for example, to</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:413pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">implement a line-editing protocol for a terminal device. Or one could implement protocols such as</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:425pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">IP or TCP without wiring them directly into the kernel.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:447pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Streams originated as an attempt to clean up a messy feature of the kernel called &#x2018;line disciplines&#x2019; &#x2014;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:459pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">alternative modes of processing character streams coming from serial terminals and early local-area</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:471pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">networks. But as serial terminals faded from view, Ethernet LANs became ubiquitous, and TCP/IP</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:483pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">drove out other protocol stacks and migrated into Unix kernels, the extra &#xfb02;exibility provided by</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:495pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">STREAMS had less and less utility. In 2003, System V Unix still supports STREAMS, as do some</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:507pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">System V/BSD hybrids such as Digital Unix and Sun Microsystems&#x2019; Solaris.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:526pt;left:72pt"><span style="font-family:Times,serif;font-size:5.018pt">76</span><span style="font-family:Times,serif;font-size:7.97pt">STREAMS was much more complex. Dennis Ritchie is reputed to have said &#x201c;Streams means something different when</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:536pt;left:72pt"><span style="font-family:Times,serif;font-size:7.97pt">shouted&#x201d;.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:262pt"><span style="font-family:Times,serif;font-size:9.963pt">209</span></p>
</div>

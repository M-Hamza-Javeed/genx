<div id="page0" style="position:relative;width:540pt;height:648pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:32pt;left:225pt"><span style="font-family:Times,serif;font-size:9.963pt">Chapter 9. Generation</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:100pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">heart of this function is the last two lines, which set attributes in the class from corresponding</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:112pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">members in the dictionary. They&#x2019;re equivalent to this:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:145pt;left:72pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">def copy_instance(toclass, fromdict):</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:156pt;left:102pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">for x in fromdict.keys():</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:167pt;left:133pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">setattr(toclass, x, fromdict[x])</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:197pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">When your code is this simple, it is far more likely to be right. See Example 9.4 for the code that</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:209pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">calls it.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:232pt;left:72pt"><b><span style="font-family:Times,serif;font-size:11.955pt">Example 9.4. Calling context for</span></b><tt><b><span style="font-family:Courier,monospace;font-size:10.76pt"> copy_instance</span></b></tt><b><span style="font-family:Times,serif;font-size:11.955pt">.</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:267pt;left:87pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt"># The tricky part - initializing objects from the &#x2018;configuration&#x2019;</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:278pt;left:87pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt"># global.</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:278pt;left:141pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">&#x2018;Configuration&#x2019; is the top level of the object tree</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:289pt;left:87pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt"># we&#x2019;re going to mung</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:300pt;left:87pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">Configuration = Controls()</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:310pt;left:87pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">copy_instance(Configuration, configuration)</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:321pt;left:87pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">Configuration.servers = [];</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:332pt;left:87pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">for server in configuration[&#x2019;servers&#x2019;]:</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:343pt;left:102pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">Newsite = Server()</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:353pt;left:102pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">copy_instance(Newsite, server)</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:364pt;left:102pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">Configuration.servers.append(Newsite)</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:375pt;left:102pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">Newsite.users = [];</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:386pt;left:102pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">for user in server[&#x2019;users&#x2019;]:</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:396pt;left:117pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">Newuser = User()</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:407pt;left:117pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">copy_instance(Newuser, user)</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:418pt;left:117pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">Newsite.users.append(Newuser)</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:448pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The key point to extract from this code is that it traverses the three levels of the initializer</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:460pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">(con&#xfb01;guration/server/user), instantiating the correct objects at each level into lists contained in the</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:472pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">next object up. Because</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> copy_instance</span></tt><span style="font-family:Times,serif;font-size:9.963pt"> is data-driven and completely generic, it can be used on</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:484pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">all three levels for three different object types.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:506pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">This is a new-school sort of example; Python was not even invented until 1990.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:506pt;left:412pt"><span style="font-family:Times,serif;font-size:9.963pt">But it re&#xfb02;ects</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:518pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">themes that go back to 1969 in the Unix tradition. If meditating on Unix programming as practiced</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:530pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">by his predecessors had not taught me constructive laziness &#x2014; insisting on reuse, and refusing to</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:262pt"><span style="font-family:Times,serif;font-size:9.963pt">258</span></p>
</div>

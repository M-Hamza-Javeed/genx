<div id="page0" style="position:relative;width:540pt;height:648pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:32pt;left:225pt"><span style="font-family:Times,serif;font-size:9.963pt">Chapter 9. Generation</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:100pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">(If either of these examples interests but mysti&#xfb01;es, read the documentation for sed(1) or awk(1). We</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:112pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">explained in Chapter 8 that the latter has largely fallen out of use. The former is still an important</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:124pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Unix tool that we haven&#x2019;t examined in detail because (a) Unix programmers already know it, and</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:136pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">(b) it&#x2019;s easy for non-Unix programmers to pick up from the manual page once they grasp the basic</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:148pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">ideas about pipelines and redirection.)</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:170pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">A new-school solution might center on this Python code, or on equivalent Perl:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:214pt;left:72pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">for row in map(lambda x:x.rstrip().split(&#x2019;:&#x2019;),sys.stdin.readlines()):</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:225pt;left:87pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">print &quot;&lt;tr&gt;&lt;td&gt;&quot; + &quot;&lt;/td&gt;&lt;td&gt;&quot;.join(row) + &quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:266pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">These scripts took about &#xfb01;ve minutes each to write and debug, certainly less time than would</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:278pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">have been required to either hand-hack the initial HTML or create and verify the database.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:278pt;left:452pt"><span style="font-family:Times,serif;font-size:9.963pt">The</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:290pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">combination of the table and this code will be much simpler to maintain than either the under-</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:302pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">engineered hand-hacked HTML or the over-engineered database.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:324pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">A further advantage of this way of solving the problem is that the master &#xfb01;le stays easy to search</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:336pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">and modify with an ordinary text editor.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:336pt;left:244pt"><span style="font-family:Times,serif;font-size:9.963pt">Another is that we can experiment with different table-</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:348pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">to-HTML transformations by tweaking the generator script, or easily make a subset of the report by</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:360pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">putting a grep(1) &#xfb01;lter before it.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:382pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">I actually use this technique to maintain the Web page that lists</span><i><span style="font-family:Times,serif;font-size:9.963pt"> fetchmail</span></i><span style="font-family:Times,serif;font-size:9.963pt"> test sites; the example</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:393pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">above is science-&#xfb01;ctional only because publishing the real data would reveal account usernames and</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:405pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">passwords.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:427pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">This was a somewhat less trivial example than the previous one. What we&#x2019;ve actually designed here</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:439pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">is a separation between content and formatting, with the generator script acting as a stylesheet. (This</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:451pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">is yet another mechanism-vs.-policy separation.)</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:473pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The lesson in all these cases is the same.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:473pt;left:249pt"><span style="font-family:Times,serif;font-size:9.963pt">Do as little work as possible.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:473pt;left:378pt"><span style="font-family:Times,serif;font-size:9.963pt">Let the data shape the</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:485pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">code. Lean on your tools. Separate mechanism from policy.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:485pt;left:328pt"><span style="font-family:Times,serif;font-size:9.963pt">Expert Unix programmers learn to</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:497pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">see possibilities like these quickly and automatically.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:497pt;left:294pt"><span style="font-family:Times,serif;font-size:9.963pt">Constructive laziness is one of the cardinal</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:509pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">virtues of the master programmer.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:262pt"><span style="font-family:Times,serif;font-size:9.963pt">264</span></p>
</div>

<div id="page0" style="position:relative;width:540pt;height:648pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:32pt;left:230pt"><span style="font-family:Times,serif;font-size:9.963pt">Chapter 20. Futures</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:100pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">primary data types &#x2014; but, because these don&#x2019;t have any canonical representation in the universe of</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:112pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">C, attempting to pass lists between (say) Perl and Python is an unnatural act requiring a lot of glue.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:134pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">There are technologies that address the larger problem, such as CORBA, but they tend to involve a</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:146pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">lot of runtime translation and be unpleasantly heavyweight.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:168pt;left:72pt"><b><span style="font-family:Helvetica,sans-serif;font-size:13.948pt">ioctl(2) and fcntl(2) Are an Embarrassment</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:194pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The ioctl(2) and fcntl(2) mechanisms provide a way to write hooks into a device driver.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:194pt;left:452pt"><span style="font-family:Times,serif;font-size:9.963pt">The</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:206pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">original, historical use of ioctl(2) was to set parameters like baud rate and number of framing bits in</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:218pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">a serial-communications driver, thus the name (for &#x2018;I/O control&#x2019;). Later, ioctl calls were added for</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:230pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">other driver functions, and fcntl(2) was added as a hook into the &#xfb01;le system.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:252pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Over the years,</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> ioctl</span></tt><span style="font-family:Times,serif;font-size:9.963pt"> and</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> fcntl</span></tt><span style="font-family:Times,serif;font-size:9.963pt"> calls have proliferated.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:252pt;left:323pt"><span style="font-family:Times,serif;font-size:9.963pt">They are often poorly documented,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:264pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">and often a source of portability problems as well.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:264pt;left:285pt"><span style="font-family:Times,serif;font-size:9.963pt">With each one comes a grubby pile of macro</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:276pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">de&#xfb01;nitions describing operation types and special argument values.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:298pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The underlying problem is the same as &#x2018;big bag of bytes&#x2019;; Unix&#x2019;s object model is weak, leaving</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:310pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">no natural places to put many auxiliary operations.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:310pt;left:301pt"><span style="font-family:Times,serif;font-size:9.963pt">Designers have an untidy choice among</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:322pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">unsatisfactory alternatives;</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> fcntl</span></tt><span style="font-family:Times,serif;font-size:9.963pt">/</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt">ioctl</span></tt><span style="font-family:Times,serif;font-size:9.963pt"> going through devices in</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> /dev</span></tt><span style="font-family:Times,serif;font-size:9.963pt">, new special-purpose</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:334pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">system calls, or hooks through special-purpose virtual &#xfb01;le systems that hook into the kernel (e.g.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:346pt;left:72pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">/proc</span></tt><span style="font-family:Times,serif;font-size:9.963pt"> under Linux and elsewhere).</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:368pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">It is not clear whether or how Unix&#x2019;s object model will be enriched in the future.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:368pt;left:409pt"><span style="font-family:Times,serif;font-size:9.963pt">If MacOS-like</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:380pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">&#xfb01;le attributes become a common feature of Unix, tweaking magic named attributes on device drivers</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:391pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">may take over the role</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> ioctl</span></tt><span style="font-family:Times,serif;font-size:9.963pt">/</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt">fcntl</span></tt><span style="font-family:Times,serif;font-size:9.963pt"> now have (this would at least have the merit of not requiring</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:403pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">piles of macro de&#xfb01;nitions before the interface could be used). We&#x2019;ve already seen that Plan 9, which</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:415pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">uses the named &#xfb01;le server or &#xfb01;le system as its basic object, rather than the &#xfb01;le/bytestream, presents</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:427pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">another possible path.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:450pt;left:72pt"><b><span style="font-family:Helvetica,sans-serif;font-size:13.948pt">The Unix Security Model May Be Too Primitive</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:476pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Perhaps root is too powerful, and Unix should have &#xfb01;ner-grained capabilities or ACLs (Access</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:488pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Control Lists) for system-administration functions, rather than one superuser that can do anything.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:500pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">People who take this position argue that too many system programs have permanent root privileges</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:512pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">through the set-user-ID mechanism; if even one can be compromised, intrusions everywhere will</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:524pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">follow.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:262pt"><span style="font-family:Times,serif;font-size:9.963pt">514</span></p>
</div>

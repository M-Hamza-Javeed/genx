<div id="page0" style="position:relative;width:540pt;height:648pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:32pt;left:209pt"><span style="font-family:Times,serif;font-size:9.963pt">Chapter 7. Multiprogramming</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:97pt;left:72pt"><b><span style="font-family:Helvetica,sans-serif;font-size:11.955pt">Case Study: The</span></b><b><i><span style="font-family:Helvetica,sans-serif;font-size:11.955pt"> mutt</span></i></b><b><span style="font-family:Helvetica,sans-serif;font-size:11.955pt"> Mail User Agent</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:121pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The</span><i><span style="font-family:Times,serif;font-size:9.963pt"> mutt</span></i><span style="font-family:Times,serif;font-size:9.963pt"> mail user agent is the modern representative of the most important design tradition in</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:133pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Unix email programs. It has a simple screen-oriented interface with single-keystroke commands for</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:145pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">browsing and reading mail.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:167pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">When you use</span><i><span style="font-family:Times,serif;font-size:9.963pt"> mutt</span></i><span style="font-family:Times,serif;font-size:9.963pt"> as a mail composer (either by calling it with an address as a command-line</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:179pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">argument or by using one of the reply commands), it examines the process environment variable</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:191pt;left:72pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">EDITOR</span></tt><span style="font-family:Times,serif;font-size:9.963pt">, and then generates a temporary &#xfb01;le name. The value of the</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> EDITOR</span></tt><span style="font-family:Times,serif;font-size:9.963pt"> variable is called as a</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:199pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">command with the temp&#xfb01;le name as an argument.</span><sup><span style="font-family:Times,serif;font-size:6.273pt">69</span></sup><sup><span style="font-family:Times,serif;font-size:9.963pt"> </span></sup><span style="font-family:Times,serif;font-size:9.963pt">When that command terminates,</span><i><span style="font-family:Times,serif;font-size:9.963pt"> mutt</span></i><span style="font-family:Times,serif;font-size:9.963pt"> resumes</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:215pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">on the assumption that the temporary &#xfb01;le contains the desired mail text.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:236pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Almost all Unix mail- and netnews-composition programs observe the same convention. Because</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:248pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">they do, composer implementers don&#x2019;t need to write a hundred inevitably diverging editors, and</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:260pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">users don&#x2019;t need to learn a hundred divergent interfaces.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:260pt;left:317pt"><span style="font-family:Times,serif;font-size:9.963pt">Instead, users can carry their chosen</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:272pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">editors with them.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:294pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">An important variant of this strategy shells out to a small proxy program that passes the specialist job</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:306pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">to an already-running instance of a big program, like an editor or a Web browser. Thus, developers</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:318pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">who normally have an instance of</span><i><span style="font-family:Times,serif;font-size:9.963pt"> emacs</span></i><span style="font-family:Times,serif;font-size:9.963pt"> running on their X display can set</span><b><span style="font-family:Times,serif;font-size:9.963pt"> EDITOR=emacsclient</span></b><span style="font-family:Times,serif;font-size:9.963pt">,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:330pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">and have a buffer pop open in their</span><i><span style="font-family:Times,serif;font-size:9.963pt"> emacs</span></i><span style="font-family:Times,serif;font-size:9.963pt"> when they request editing in</span><i><span style="font-family:Times,serif;font-size:9.963pt"> mutt</span></i><span style="font-family:Times,serif;font-size:9.963pt">.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:330pt;left:391pt"><span style="font-family:Times,serif;font-size:9.963pt">The point of this is</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:342pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">not really to save memory or other resources, it&#x2019;s to enable the user to unify all editing in a single</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:353pt;left:72pt"><i><span style="font-family:Times,serif;font-size:9.963pt">emacs</span></i><span style="font-family:Times,serif;font-size:9.963pt"> process (so that, for example, cut and paste among buffers can carry along internal</span><i><span style="font-family:Times,serif;font-size:9.963pt"> emacs</span></i></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:365pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">state information like font highlighting).</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:387pt;left:72pt"><b><span style="font-family:Helvetica,sans-serif;font-size:13.948pt">Pipes, Redirection, and Filters</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:413pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">After Ken Thompson and Dennis Ritchie, the single most important formative &#xfb01;gure of early Unix</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:425pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">was probably Doug McIlroy. His invention of the</span><i><span style="font-family:Times,serif;font-size:9.963pt"> pipe</span></i><span style="font-family:Times,serif;font-size:9.963pt"> construct reverberated through the design of</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:437pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Unix, encouraging its nascent do-one-thing-well philosophy and inspiring most of the later forms of</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:449pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">IPC in the Unix design (in particular, the socket abstraction used for networking).</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:471pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Pipes depend on the convention that every program has initially available to it (at least) two I/O data</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:483pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">streams: standard input and standard output (numeric &#xfb01;le descriptors 0 and 1 respectively). Many</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:495pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">programs can be written as</span><i><span style="font-family:Times,serif;font-size:9.963pt"> &#xfb01;lters</span></i><span style="font-family:Times,serif;font-size:9.963pt">, which read sequentially from standard input and write only to</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:507pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">standard output.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:526pt;left:72pt"><span style="font-family:Times,serif;font-size:5.018pt">69</span><span style="font-family:Times,serif;font-size:7.97pt">Actually, the above is a slight oversimpli&#xfb01;cation. See the discussion of</span><tt><span style="font-family:Courier,monospace;font-size:7.173pt"> EDITOR</span></tt><span style="font-family:Times,serif;font-size:7.97pt"> and</span><tt><span style="font-family:Courier,monospace;font-size:7.173pt"> VISUAL</span></tt><span style="font-family:Times,serif;font-size:7.97pt"> in Chapter 10 for the rest of</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:536pt;left:72pt"><span style="font-family:Times,serif;font-size:7.97pt">the story.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:262pt"><span style="font-family:Times,serif;font-size:9.963pt">192</span></p>
</div>

<div id="page0" style="position:relative;width:540pt;height:648pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:32pt;left:218pt"><span style="font-family:Times,serif;font-size:9.963pt">Chapter 8. Minilanguages</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:100pt;left:301pt"><span style="font-family:Times,serif;font-size:9.963pt">&lt;author&gt;SteveJohnson&lt;/author&gt;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:122pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">On this issue, as elsewhere, there is no substitute for good taste and engineering judgment.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:122pt;left:461pt"><span style="font-family:Times,serif;font-size:9.963pt">If</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:134pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">you&#x2019;re going to design a minilanguage, don&#x2019;t do it halfway. Declarative minilanguages should have</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:146pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">a clear, consistent language-like syntax designed to be readable by humans. Imperative ones should</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:158pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">add a full range of control structures adapted from language models you can expect your users to be</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:170pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">familiar with.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:170pt;left:135pt"><span style="font-family:Times,serif;font-size:9.963pt">Think about the language</span><i><span style="font-family:Times,serif;font-size:9.963pt"> as</span></i><span style="font-family:Times,serif;font-size:9.963pt"> a language; ask yourself esthetic questions like &#x201c;Will</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:181pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">this be comfortable to program in?&#x201d; and even &#x201c;Will it be pleasant to look at?&#x201d; Here, as elsewhere in</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:193pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">software design, David Gelernter&#x2019;s maxim is apt: beauty is the ultimate defense against complexity.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:216pt;left:71pt"><b><span style="font-family:Helvetica,sans-serif;font-size:13.948pt">Extending and Embedding Languages</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:242pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">One fundamentally important question is whether you can implement your minilanguage by extend-</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:254pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">ing or embedding an existing scripting language. This is often the right way to go for an imperative</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:266pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">minilanguage, but much less appropriate for a declarative one.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:288pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">Sometimes it&#x2019;s possible to write your imperative language simply by coding service functions in</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:300pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">an interpreted language, which we&#x2019;ll call the &#x2018;host&#x2019; language for purposes of this discussion. Your</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:312pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">minilanguage programs are then just scripts that load your service library and use the host language&#x2019;s</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:324pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">control structures and other facilities as a framework.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:324pt;left:295pt"><span style="font-family:Times,serif;font-size:9.963pt">Every facility the host language supplies is</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:336pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">one you don&#x2019;t have to write.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:358pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">This is the easiest way to write a minilanguage.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:358pt;left:282pt"><span style="font-family:Times,serif;font-size:9.963pt">Old-school Lisp programmers (including me)</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:370pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">love this technique and use it heavily.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:370pt;left:236pt"><span style="font-family:Times,serif;font-size:9.963pt">It underlies the design of the</span><i><span style="font-family:Times,serif;font-size:9.963pt"> Emacs</span></i><span style="font-family:Times,serif;font-size:9.963pt"> editor, and has been</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:382pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">rediscovered in the new-school scripting languages like Tcl, Python, and Perl. There are drawbacks</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:393pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">to it, however.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:415pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Your host language may be unable to interface to a code library that you need.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:415pt;left:399pt"><span style="font-family:Times,serif;font-size:9.963pt">Or, internally, its</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:427pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">ontology of data types may be inadequate for the kind of computation you need to do.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:427pt;left:433pt"><span style="font-family:Times,serif;font-size:9.963pt">Or, after</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:439pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">measuring the performance of a prototype, you discover that it&#x2019;s too slow. When any of these things</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:451pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">happen, your solution is usually going to involve coding in C (or C++) and integrating the results</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:463pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">into your minilanguage.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:485pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The option of extending a scripting language with C code, or of embedding a scripting language in</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:497pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">a C program, relies on the existence of scripting languages designed for it. You extend a scripting</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:509pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">language by telling it to dynamically load a C library or module in such a way that the C entry</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:521pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">points become visible as functions in the extended language. You embed a scripting language in a</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:262pt"><span style="font-family:Times,serif;font-size:9.963pt">244</span></p>
</div>

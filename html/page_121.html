<div id="page0" style="position:relative;width:540pt;height:648pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:32pt;left:225pt"><span style="font-family:Times,serif;font-size:9.963pt">Chapter 4. Modularity</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:100pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">An analogous choice shows up in a lot of different contexts. Suppose you&#x2019;re writing MIDI sequencer</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:112pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">software. You could organize that code around its top level (sequencing tracks) or around its bottom</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:124pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">level (switching patches or samples and driving wave generators).</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:146pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">A very concrete way to think about this difference is to ask whether the design is organized around</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:158pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">its main event loop (which tends to have the high-level application logic close to it) or around a</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:170pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">service library of all the operations that the main loop can invoke. A designer working from the top</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:181pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">down will start by thinking about the program&#x2019;s main event loop, and plug in speci&#xfb01;c events later.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:193pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">A designer working from the bottom up will start by thinking about encapsulating speci&#xfb01;c tasks and</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:205pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">glue them together into some kind of coherent order later on.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:227pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">For a larger example, consider the design of a Web browser.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:227pt;left:340pt"><span style="font-family:Times,serif;font-size:9.963pt">The top-level design of a Web</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:239pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">browser is a speci&#xfb01;cation of the expected behavior of the browser: what types of URL (like</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> http:</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:251pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">or</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> ftp:</span></tt><span style="font-family:Times,serif;font-size:9.963pt"> or</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> file:</span></tt><span style="font-family:Times,serif;font-size:9.963pt">) it interprets, what kinds of images it is expected to be able to render, whether</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:263pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">and with what limitations it will accept Java or JavaScript, etc.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:263pt;left:337pt"><span style="font-family:Times,serif;font-size:9.963pt">The layer of the implementation</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:275pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">that corresponds to this top-level view is its main event loop; each time around, the loop waits for,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:287pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">collects, and dispatches on a user action (such as clicking a Web link or typing a character into a</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:299pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">&#xfb01;eld).</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:321pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">But the Web browser has to call a large set of domain primitives to do its job. One group of these is</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:333pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">concerned with establishing network connections, sending data over them, and receiving responses.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:345pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Another set is the operations of the GUI toolkit the browser will use.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:345pt;left:370pt"><span style="font-family:Times,serif;font-size:9.963pt">Yet a third set might be</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:357pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">concerned with the mechanics of parsing retrieved HTML from text into a document object tree.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:379pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Which end of the stack you start with matters a lot, because the layer at the other end is quite likely to</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:391pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">be constrained by your initial choices. In particular, if you program purely from the top down, you</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:403pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">may &#xfb01;nd yourself in the uncomfortable position that the domain primitives your application logic</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:415pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">wants don&#x2019;t match the ones you can actually implement. On the other hand, if you program purely</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:427pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">from the bottom up, you may &#xfb01;nd yourself doing a lot of work that is irrelevant to the application</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:439pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">logic &#x2014; or merely designing a pile of bricks when you were trying to build a house.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:460pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Ever since the structured-programming controversies of the 1960s, novice programmers have</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:472pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">generally been taught that the correct approach is the top-down one: stepwise re&#xfb01;nement, where</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:484pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">you specify what your program is to do at an abstract level and gradually &#xfb01;ll in the blanks of</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:496pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">implementation until you have concrete working code. Top-down tends to be good practice when</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:508pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">three preconditions are true: (a) you can specify in advance precisely what the program is to do, (b)</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:520pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">the speci&#xfb01;cation is unlikely to change signi&#xfb01;cantly during implementation, and (c) you have a lot of</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:532pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">freedom in choosing, at a low level, how the program is to get that job done.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:262pt"><span style="font-family:Times,serif;font-size:9.963pt">120</span></p>
</div>

<div id="page0" style="position:relative;width:540pt;height:648pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:32pt;left:224pt"><span style="font-family:Times,serif;font-size:9.963pt">Chapter 17. Portability</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:100pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Dennis Ritchie&#x2019;s original C compiler (often called the &#x201c;DMR&#x201d; compiler after his initials) served the</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:112pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">rapidly growing community around Unix versions 5, 6, and 7.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:112pt;left:329pt"><span style="font-family:Times,serif;font-size:9.963pt">Version 6 C spawned Whitesmiths</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:124pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">C, a reimplementation that became the &#xfb01;rst commercial C compiler and the nucleus of IDRIS, the</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:136pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">&#xfb01;rst Unix workalike. But most modern C implementations are patterned on Steven C. Johnson&#x2019;s</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:148pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">&#x201c;portable C compiler&#x201d; (PCC) which debuted in Version 7 and replaced the DMR compiler entirely</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:160pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">in both System V and the BSD 4.x releases.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:181pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">In 1976, Version 6 C introduced the</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> typedef</span></tt><span style="font-family:Times,serif;font-size:9.963pt">,</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> union</span></tt><span style="font-family:Times,serif;font-size:9.963pt">, and</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> unsigned int</span></tt><span style="font-family:Times,serif;font-size:9.963pt"> declarations.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:181pt;left:452pt"><span style="font-family:Times,serif;font-size:9.963pt">The</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:193pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">approved syntax for variable initializations and some compound operators also changed.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:215pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The original description of C was Brian Kernighan and Dennis M. Ritchie&#x2019;s original</span><i><span style="font-family:Times,serif;font-size:9.963pt"> The C</span></i></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:227pt;left:72pt"><i><span style="font-family:Times,serif;font-size:9.963pt">Programming Language</span></i><span style="font-family:Times,serif;font-size:9.963pt"> aka &#x201c;the White Book&#x201d; [Kernighan-Ritchie].</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:227pt;left:363pt"><span style="font-family:Times,serif;font-size:9.963pt">It was published in 1978,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:239pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">the same year the Whitemiths C compiler became available.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:261pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The White Book described enhanced Version 6 C, with one signi&#xfb01;cant exception involving the</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:273pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">handling of public storage. Ritchie&#x2019;s original intention had been to model C&#x2019;s rules on FORTRAN</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:285pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">COMMON declarations, on the theory that any machine that could handle FORTRAN would be</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:297pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">ready for C.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:297pt;left:132pt"><span style="font-family:Times,serif;font-size:9.963pt">In the common-block model, a public variable may be declared multiple times;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:309pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">identical declarations are merged by the linker.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:309pt;left:276pt"><span style="font-family:Times,serif;font-size:9.963pt">But two early C ports (to Honeywell and IBM</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:321pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">360 mainframes) happened to be to machines with very limited common storage or a primitive</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:333pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">linker or both.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:333pt;left:145pt"><span style="font-family:Times,serif;font-size:9.963pt">Thus, the Version 6 C compiler was moved to the stricter de&#xfb01;nition-reference</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:345pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">model (requiring at most one de&#xfb01;nition of any given public variable and the</span><b><span style="font-family:Times,serif;font-size:9.963pt"> extern</span></b><span style="font-family:Times,serif;font-size:9.963pt"> keyword tagging</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:357pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">references to it) described in [Kernighan-Ritchie].</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:379pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">This decision was reversed in the C compiler that shipped with Version 7 after it developed that a</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:391pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">great deal of existing source depended on the looser rules.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:391pt;left:321pt"><span style="font-family:Times,serif;font-size:9.963pt">Pressure for backward-compatibility</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:403pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">would foil yet another attempt to switch (in 1983&#x2019;s System V Release 1) before the ANSI Draft</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:415pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Standard &#xfb01;nally settled on de&#xfb01;nition-reference rules in 1988. Common-block public storage is still</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:427pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">admitted as an acceptable variation by the standard.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:448pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">V7 C introduced</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> enum</span></tt><span style="font-family:Times,serif;font-size:9.963pt"> and treated</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> struct</span></tt><span style="font-family:Times,serif;font-size:9.963pt"> and</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> union</span></tt><span style="font-family:Times,serif;font-size:9.963pt"> values as &#xfb01;rst-class objects that could be</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:460pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">assigned, passed as arguments, and returned from functions (rather than being passed around by</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:472pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">address).</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:494pt;left:108pt"><span style="font-family:Times,serif;font-size:9.963pt">Another major change in V7 was that Unix data structure declarations were now</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:506pt;left:108pt"><span style="font-family:Times,serif;font-size:9.963pt">documented on header &#xfb01;les, and included. Previous Unixes had actually printed</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:518pt;left:108pt"><span style="font-family:Times,serif;font-size:9.963pt">the data structures (e.g., for directories) in the manual, from which people would</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:530pt;left:108pt"><span style="font-family:Times,serif;font-size:9.963pt">copy it into their code. Needless to say, this was a major portability problem.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:262pt"><span style="font-family:Times,serif;font-size:9.963pt">435</span></p>
</div>

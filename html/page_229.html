<div id="page0" style="position:relative;width:540pt;height:648pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:32pt;left:218pt"><span style="font-family:Times,serif;font-size:9.963pt">Chapter 8. Minilanguages</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:100pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The</span><i><span style="font-family:Times,serif;font-size:9.963pt"> m4</span></i><span style="font-family:Times,serif;font-size:9.963pt"> macro processor is usually employed as a preprocessor for minilanguages that lack a built-in</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:112pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">notion of named procedures or a built-in &#xfb01;le-inclusion feature. It&#x2019;s an easy way to extend the syntax</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:124pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">of the base language so the combination with</span><i><span style="font-family:Times,serif;font-size:9.963pt"> m4</span></i><span style="font-family:Times,serif;font-size:9.963pt"> supports both these features.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:145pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">One well-known use of</span><i><span style="font-family:Times,serif;font-size:9.963pt"> m4</span></i><span style="font-family:Times,serif;font-size:9.963pt"> has been to clean up (or at least effectively hide) another minilanguage</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:157pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">design that was called out as a bad example earlier in this chapter.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:157pt;left:356pt"><span style="font-family:Times,serif;font-size:9.963pt">Most system administrators</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:169pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">now generate their</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> sendmail.cf</span></tt><span style="font-family:Times,serif;font-size:9.963pt"> con&#xfb01;guration &#xfb01;les using an</span><i><span style="font-family:Times,serif;font-size:9.963pt"> m4</span></i><span style="font-family:Times,serif;font-size:9.963pt"> macro package supplied with the</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:181pt;left:72pt"><i><span style="font-family:Times,serif;font-size:9.963pt">sendmail</span></i><span style="font-family:Times,serif;font-size:9.963pt"> distribution. The macros start from feature names (or name/value pairs) and generate the</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:193pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">corresponding (much uglier) strings in the</span><i><span style="font-family:Times,serif;font-size:9.963pt"> sendmail</span></i><span style="font-family:Times,serif;font-size:9.963pt"> con&#xfb01;guration language.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:214pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Use</span><i><span style="font-family:Times,serif;font-size:9.963pt"> m4</span></i><span style="font-family:Times,serif;font-size:9.963pt"> with caution, however.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:214pt;left:204pt"><span style="font-family:Times,serif;font-size:9.963pt">Unix experience has taught minilanguage designers to be wary of</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:222pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">macro expansion,</span><sup><span style="font-family:Times,serif;font-size:6.273pt">83</span></sup><sup><span style="font-family:Times,serif;font-size:9.963pt"> </span></sup><span style="font-family:Times,serif;font-size:9.963pt">for reasons we&#x2019;ll discuss later in the chapter.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:248pt;left:72pt"><b><span style="font-family:Helvetica,sans-serif;font-size:13.948pt">Case Study: XSLT</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:273pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">XSLT, like</span><i><span style="font-family:Times,serif;font-size:9.963pt"> m4</span></i><span style="font-family:Times,serif;font-size:9.963pt"> macros, is a language for describing transformations of a text stream.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:273pt;left:423pt"><span style="font-family:Times,serif;font-size:9.963pt">But it does</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:285pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">much more than simple macro substitution; it describes transformations of XML data, including</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:297pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">query and report generation.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:297pt;left:200pt"><span style="font-family:Times,serif;font-size:9.963pt">It is the language used to write XML stylesheets.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:297pt;left:416pt"><span style="font-family:Times,serif;font-size:9.963pt">For practical</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:309pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">applications, see the description of XML document processing in Chapter 18.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:309pt;left:393pt"><span style="font-family:Times,serif;font-size:9.963pt">XSLT is described</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:321pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">by a World Wide Web Consortium standard and has several open-source implementations.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:342pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">XSLT and</span><i><span style="font-family:Times,serif;font-size:9.963pt"> m4</span></i><span style="font-family:Times,serif;font-size:9.963pt"> macros are both purely declarative and Turing-complete, but XSLT supports only</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:354pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">recursions and not loops. It is quite complex, certainly the most dif&#xfb01;cult language to master of any</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:366pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">in this chapter&#x2019;s case studies &#x2014; and probably the most dif&#xfb01;cult of any language mentioned in this</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:378pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">book.</span><sup><span style="font-family:Times,serif;font-size:6.273pt">84</span></sup></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:400pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Despite its complexity, XSLT really is a minilanguage.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:400pt;left:300pt"><span style="font-family:Times,serif;font-size:9.963pt">It shares important (though not universal)</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:412pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">characteristics of the breed:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:444pt;left:81pt"><span style="font-family:Times,serif;font-size:9.963pt">&#x2022; A restricted ontology of types, with (in particular) no analog of record structures or arrays.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:465pt;left:81pt"><span style="font-family:Times,serif;font-size:9.963pt">&#x2022; Restricted interface to the rest of the world.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:465pt;left:275pt"><span style="font-family:Times,serif;font-size:9.963pt">XSLT processors are designed to &#xfb01;lter standard</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:477pt;left:86pt"><span style="font-family:Times,serif;font-size:9.963pt">input to standard output, with a limited ability to read and write &#xfb01;les. They can&#x2019;t open sockets</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:489pt;left:86pt"><span style="font-family:Times,serif;font-size:9.963pt">or run subcommands.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:517pt;left:72pt"><span style="font-family:Times,serif;font-size:5.018pt">83</span><span style="font-family:Times,serif;font-size:7.97pt">Whether or not &#x201c;macro expansion&#x201d; should be spelled &#x201c;macroexpansion&#x201d; is a matter for some dispute. The latter is found</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:526pt;left:72pt"><span style="font-family:Times,serif;font-size:7.97pt">mainly among Lisp programmers.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:536pt;left:72pt"><span style="font-family:Times,serif;font-size:5.018pt">84</span><span style="font-family:Times,serif;font-size:7.97pt">It is not clear that XSLT could be any simpler and still do its job, however, so we cannot characterize it as a bad design.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:262pt"><span style="font-family:Times,serif;font-size:9.963pt">228</span></p>
</div>

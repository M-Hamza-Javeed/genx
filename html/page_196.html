<div id="page0" style="position:relative;width:540pt;height:648pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:32pt;left:209pt"><span style="font-family:Times,serif;font-size:9.963pt">Chapter 7. Multiprogramming</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:100pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">your shell, set the environment variable</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> PAGER</span></tt><span style="font-family:Times,serif;font-size:9.963pt"> to &#x2018;less&#x2019; (see Chapter 10), and get all the bene&#xfb01;ts of</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:112pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">a better pager with all properly-written Unix programs.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:134pt;left:72pt"><b><span style="font-family:Helvetica,sans-serif;font-size:11.955pt">Case Study: Making Word Lists</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:158pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">A more interesting example is one in which pipelined programs cooperate to do some kind of data</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:170pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">transformation for which, in less &#xfb02;exible environments, one would have to write custom code.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:192pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Consider the pipeline</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:225pt;left:72pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">tr -c &#x2019;[:alnum:]&#x2019; &#x2019;[\n*]&#x2019; | sort -iu | grep -v &#x2019;^[0-9]*$&#x2019;</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:256pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The &#xfb01;rst command translates non-alphanumerics on standard input to newlines on standard output.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:268pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The second sorts lines on standard input and writes the sorted data to standard output, discarding all</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:280pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">but one copy of spans of adjacent identical lines.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:280pt;left:278pt"><span style="font-family:Times,serif;font-size:9.963pt">The third discards all lines consisting solely of</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:292pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">digits. Together, these generate a sorted wordlist to standard output from text on standard input.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:314pt;left:72pt"><b><span style="font-family:Helvetica,sans-serif;font-size:11.955pt">Case Study:</span></b><b><i><span style="font-family:Helvetica,sans-serif;font-size:11.955pt"> pic2graph</span></i></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:338pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Shell source code for the program pic2graph(1) ships with the</span><i><span style="font-family:Times,serif;font-size:9.963pt"> groff</span></i><span style="font-family:Times,serif;font-size:9.963pt"> suite of text-formatting tools</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:350pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">from the Free Software Foundation.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:350pt;left:225pt"><span style="font-family:Times,serif;font-size:9.963pt">It translates diagrams written in the PIC language to bitmap</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:362pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">images. Example 7.1 shows the pipeline at the heart of this code.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:384pt;left:72pt"><b><span style="font-family:Times,serif;font-size:11.955pt">Example 7.1. The</span></b><b><i><span style="font-family:Times,serif;font-size:11.955pt"> pic2graph</span></i></b><b><span style="font-family:Times,serif;font-size:11.955pt"> pipeline.</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:431pt;left:72pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">(echo &quot;.EQ&quot;; echo $eqndelim; echo &quot;.EN&quot;; echo &quot;.PS&quot;;cat;echo &quot;.PE&quot;)|\</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:441pt;left:91pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">groff -e -p $groffpic_opts -Tps &gt;${tmp}.ps \</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:452pt;left:91pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">&amp;&amp; convert -crop 0x0 $convert_opts ${tmp}.ps ${tmp}.${format} \</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:463pt;left:91pt"><tt><span style="font-family:Courier,monospace;font-size:8.966pt">&amp;&amp; cat ${tmp}.${format}</span></tt></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:504pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The pic2graph(1) implementation illustrates how much one pipeline can do purely by calling</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:516pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">preexisting tools. It starts by massaging its input into an appropriate form, continues by feeding it</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:528pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">through groff(1) to produce PostScript, and &#xfb01;nishes by converting the PostScript to a bitmap.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:528pt;left:455pt"><span style="font-family:Times,serif;font-size:9.963pt">All</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:262pt"><span style="font-family:Times,serif;font-size:9.963pt">195</span></p>
</div>

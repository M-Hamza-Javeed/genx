<div id="page0" style="position:relative;width:540pt;height:648pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:32pt;left:225pt"><span style="font-family:Times,serif;font-size:9.963pt">Chapter 4. Modularity</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:100pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The basic Unix APIs were designed for orthogonality with imperfect but considerable success. We</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:112pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">take for granted being able to open a &#xfb01;le for write access without exclusive-locking it for write,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:124pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">for example; not all operating systems are so graceful.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:124pt;left:303pt"><span style="font-family:Times,serif;font-size:9.963pt">Old-style (System III) signals were non-</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:136pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">orthogonal, because signal receipt had the side-effect of resetting the signal handler to the default</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:148pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">die-on-receipt.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:148pt;left:140pt"><span style="font-family:Times,serif;font-size:9.963pt">There are large non-orthogonal patches like the BSD sockets API and</span><i><span style="font-family:Times,serif;font-size:9.963pt"> very</span></i><span style="font-family:Times,serif;font-size:9.963pt"> large</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:160pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">ones like the X windowing system&#x2019;s drawing libraries.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:181pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">But on the whole the Unix API is a good example: Otherwise it not only would not but</span><i><span style="font-family:Times,serif;font-size:9.963pt"> could</span></i><span style="font-family:Times,serif;font-size:9.963pt"> not</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:193pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">be so widely imitated by C libraries on other operating systems. This is also a reason that the Unix</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:205pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">API repays study even if you are not a Unix programmer; it has lessons about orthogonality to teach.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:228pt;left:72pt"><b><span style="font-family:Helvetica,sans-serif;font-size:13.948pt">The SPOT Rule</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:254pt;left:72pt"><i><span style="font-family:Times,serif;font-size:9.963pt">The Pragmatic Programmer</span></i><span style="font-family:Times,serif;font-size:9.963pt"> articulates a rule for one particular kind of orthogonality that is</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:266pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">especially important. Their &#x201c;Don&#x2019;t Repeat Yourself&#x201d; rule is: every piece of knowledge must have a</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:278pt;left:72pt"><i><span style="font-family:Times,serif;font-size:9.963pt">single</span></i><span style="font-family:Times,serif;font-size:9.963pt">, unambiguous, authoritative representation within a system. In this book we prefer, following</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:290pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">a suggestion by Brian Kernighan, to call this the Single Point Of Truth or SPOT rule.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:312pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Repetition leads to inconsistency and code that is subtly broken, because you changed only some</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:324pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">repetitions when you needed to change</span><i><span style="font-family:Times,serif;font-size:9.963pt"> all</span></i><span style="font-family:Times,serif;font-size:9.963pt"> of them. Often, it also means that you haven&#x2019;t properly</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:336pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">thought through the organization of your code.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:358pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Constants, tables, and metadata should be declared and initialized</span><i><span style="font-family:Times,serif;font-size:9.963pt"> once</span></i><span style="font-family:Times,serif;font-size:9.963pt"> and imported elsewhere.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:370pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Any time you see duplicate code, that&#x2019;s a danger sign. Complexity is a cost; don&#x2019;t pay it twice.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:391pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Often it&#x2019;s possible to remove code duplication by</span><i><span style="font-family:Times,serif;font-size:9.963pt"> refactoring</span></i><span style="font-family:Times,serif;font-size:9.963pt">; that is, changing the organization of</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:403pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">your code without changing the core algorithms. Data duplication sometimes appears to be forced</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:415pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">on you. But when you see it, here are some valuable questions to ask:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:449pt;left:81pt"><span style="font-family:Times,serif;font-size:9.963pt">&#x2022; If you have duplicated data in your code because it has to have two different representations in</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:461pt;left:86pt"><span style="font-family:Times,serif;font-size:9.963pt">two different places, can you write a function, tool or code generator to make one representation</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:473pt;left:86pt"><span style="font-family:Times,serif;font-size:9.963pt">from the other, or both from a common source?</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:495pt;left:81pt"><span style="font-family:Times,serif;font-size:9.963pt">&#x2022; If your documentation duplicates knowledge in your code, can you generate parts of the</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:507pt;left:86pt"><span style="font-family:Times,serif;font-size:9.963pt">documentation from parts of the code, or vice-versa, or both from a common higher-level</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:519pt;left:86pt"><span style="font-family:Times,serif;font-size:9.963pt">representation?</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:262pt"><span style="font-family:Times,serif;font-size:9.963pt">115</span></p>
</div>

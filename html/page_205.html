<div id="page0" style="position:relative;width:540pt;height:648pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:32pt;left:209pt"><span style="font-family:Times,serif;font-size:9.963pt">Chapter 7. Multiprogramming</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:100pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">When you invoke</span><b><span style="font-family:Times,serif;font-size:9.963pt"> fetchmail</span></b><span style="font-family:Times,serif;font-size:9.963pt"> with no arguments, it checks to see if you have a</span><i><span style="font-family:Times,serif;font-size:9.963pt"> fetchmail</span></i><span style="font-family:Times,serif;font-size:9.963pt"> daemon</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:112pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">already running (it does this by looking for a pid&#xfb01;le). If no daemon is running,</span><i><span style="font-family:Times,serif;font-size:9.963pt"> fetchmail</span></i><span style="font-family:Times,serif;font-size:9.963pt"> starts up</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:124pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">normally using whatever control information has been speci&#xfb01;ed in its run-control &#xfb01;le. If a daemon is</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:136pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">running, on the other hand, the new</span><i><span style="font-family:Times,serif;font-size:9.963pt"> fetchmail</span></i><span style="font-family:Times,serif;font-size:9.963pt"> instance just signals the old one to wake up and collect</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:148pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">mail immediately; then the new instance terminates. In addition,</span><b><span style="font-family:Times,serif;font-size:9.963pt"> fetchmail -q</span></b><span style="font-family:Times,serif;font-size:9.963pt"> sends a termination</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:160pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">signal to any running</span><i><span style="font-family:Times,serif;font-size:9.963pt"> fetchmail</span></i><span style="font-family:Times,serif;font-size:9.963pt"> daemon.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:181pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Thus, typing</span><b><span style="font-family:Times,serif;font-size:9.963pt"> fetchmail</span></b><span style="font-family:Times,serif;font-size:9.963pt"> means, in effect, &#x201c;poll now and leave a daemon running to poll later; don&#x2019;t</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:193pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">bother me with the detail of whether a daemon was already running or not&#x201d;. Observe that the detail</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:205pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">of which particular signals are used for wakeup and termination is something the user doesn&#x2019;t have</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:217pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">to know.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:239pt;left:72pt"><b><span style="font-family:Helvetica,sans-serif;font-size:11.955pt">Sockets</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:264pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Sockets were developed in the BSD lineage of Unix as a way to encapsulate access to data networks.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:276pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Two programs communicating over a socket typically see a bidirectional byte stream (there are other</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:287pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">socket modes and transmission methods, but they are of only minor importance). The byte stream</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:299pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">is both sequenced (that is, even single bytes will be received in the same order sent) and reliable</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:311pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">(socket users are guaranteed that the underlying network will do error detection and retry to ensure</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:323pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">delivery). Socket descriptors, once obtained, behave essentially like &#xfb01;le descriptors.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:345pt;left:108pt"><span style="font-family:Times,serif;font-size:9.963pt">Sockets differ from read/write in one important case. If the bytes you send arrive,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:357pt;left:108pt"><span style="font-family:Times,serif;font-size:9.963pt">but the receiving machine fails to ACK, the sending machine&#x2019;s TCP/IP stack will</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:369pt;left:108pt"><span style="font-family:Times,serif;font-size:9.963pt">time out.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:369pt;left:157pt"><span style="font-family:Times,serif;font-size:9.963pt">So getting an error does</span><i><span style="font-family:Times,serif;font-size:9.963pt"> not</span></i><span style="font-family:Times,serif;font-size:9.963pt"> necessarily mean that the bytes didn&#x2019;t</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:381pt;left:108pt"><span style="font-family:Times,serif;font-size:9.963pt">arrive; the receiver may be using them. This problem has profound consequences</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:393pt;left:108pt"><span style="font-family:Times,serif;font-size:9.963pt">for the design of reliable protocols, because you have to be able to work properly</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:405pt;left:108pt"><span style="font-family:Times,serif;font-size:9.963pt">when you don&#x2019;t know what was received in the past.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:405pt;left:342pt"><span style="font-family:Times,serif;font-size:9.963pt">Local I/O is &#x2018;yes/no&#x2019;.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:417pt;left:108pt"><span style="font-family:Times,serif;font-size:9.963pt">Socket I/O is &#x2018;yes/no/maybe&#x2019;. And nothing can ensure delivery &#x2014; the remote</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:429pt;left:108pt"><span style="font-family:Times,serif;font-size:9.963pt">machine might have been destroyed by a comet.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:441pt;left:422pt"><span style="font-family:Times,serif;font-size:9.963pt">&#x2014;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:453pt;left:311pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">&lt;author&gt;KenArnold&lt;/author&gt;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:475pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">At the time a socket is created, you specify a</span><i><span style="font-family:Times,serif;font-size:9.963pt"> protocol family</span></i><span style="font-family:Times,serif;font-size:9.963pt"> which tells the network layer</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:487pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">how the name of the socket is interpreted.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:487pt;left:258pt"><span style="font-family:Times,serif;font-size:9.963pt">Sockets are usually thought of in connection with</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:499pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">the Internet, as a way of passing data between programs running on different hosts; this is</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:511pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">the AF_INET socket family, in which addresses are interpreted as host-address and service-</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:523pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">number pairs.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:523pt;left:137pt"><span style="font-family:Times,serif;font-size:9.963pt">However, the AF_UNIX (aka AF_LOCAL) protocol family supports the same</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:535pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">socket abstraction for communication between two processes on the same machine (names are</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:262pt"><span style="font-family:Times,serif;font-size:9.963pt">204</span></p>
</div>

<div id="page0" style="position:relative;width:612pt;height:792pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:95pt;left:108pt"><i><span style="font-family:BookAntiqua,serif;font-size:9pt">Organizing Templates with AMD and Require.js</span></i></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:666pt;left:293pt"><b><span style="font-family:Arial,sans-serif;font-size:9pt">[</span></b><b><span style="font-family:Arial,sans-serif;font-size:8pt"> 146 </span></b><b><span style="font-family:Arial,sans-serif;font-size:9pt">]</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:115pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">      // Compile the template string that we received </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:127pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">      template: _.template(userLoginTpl),</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:139pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">      render: function () {</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:152pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">        this.$el.html(this.template({</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:164pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">          username: &apos;johndoe&apos;,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:176pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">          password: &apos;john&apos;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:188pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">        }));</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:213pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">        return this;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:225pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">      }</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:237pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">    });</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:262pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">    return UserLogin;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:274pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  });</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:293pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">The benefit of using</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> this mechanism is that you can organize your templates by </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:306pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">creating separate template files and they are automatically included in your modules. </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:318pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Since this involves asynchronous loading, the files are downloaded via AJAX </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:331pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">requests, something we already decided as being a bad idea. However, Require.js </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:344pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">comes with an </span><span style="font-family:CourierStd,serif;font-size:9.5pt">r.js</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> optimization tool that builds the modules and can save these </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:356pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">extra AJAX requests by inlining these templates with their respective modules.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:390pt;left:108pt"><b><span style="font-family:Arial,sans-serif;font-size:20pt">Precompiling with the requirejs-tpl plugin</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:414pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">With AMD, we </span><span style="font-family:BookAntiqua,serif;font-size:10.5pt">simplified the template </span><span style="font-family:BookAntiqua,serif;font-size:10.5pt">organization process, but the end result still </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:426pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">remains an uncompiled template string. In </span><i><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Chapter 2</span></i><span style="font-family:BookAntiqua,serif;font-size:10.5pt">, </span><i><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Working with Views</span></i><span style="font-family:BookAntiqua,serif;font-size:10.5pt">, we saw how </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:439pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">template compilation affects application performance every time and we also analyzed </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:451pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">the benefits of precompiling templates. Won&apos;t it be useful if we have something that </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:464pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">will load these template files and provide us with an already-compiled template </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:477pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">string instead? Fortunately, there are multiple </span><span style="font-family:CourierStd,serif;font-size:9.5pt">tpl</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> plugins available for Require.js </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:489pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">that automate template compilation, and you can use these plugins directly in your </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:502pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">module definition. Let us look at a similar plugin (</span><span style="font-family:CourierStd,serif;font-size:9.5pt">https://github.com/ZeeAgency/</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:514pt;left:107pt"><span style="font-family:CourierStd,serif;font-size:9.5pt">requirejs-tpl</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt">) developed by ZeeAgency. Dependency loading is exactly the same as </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:527pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">it is for the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">text</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> plugin, you just need to use the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">tpl!</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> plugin prefix instead of </span><span style="font-family:CourierStd,serif;font-size:9.5pt">text!</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt">:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:548pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt"> define([&apos;tpl!your-template-path.tpl&apos;], function (template) { </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:561pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  return template ({</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:573pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">    your: &apos;data&apos;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:585pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  });</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:597pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">});</span></p>
</div>

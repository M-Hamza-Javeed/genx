<div id="page0" style="position:relative;width:540pt;height:648pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:32pt;left:225pt"><span style="font-family:Times,serif;font-size:9.963pt">Chapter 4. Modularity</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:100pt;left:108pt"><span style="font-family:Times,serif;font-size:9.963pt">APIs should come with programs, and vice versa. An API that you must write C</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:112pt;left:108pt"><span style="font-family:Times,serif;font-size:9.963pt">code to use, which cannot be invoked easily from the command line, is harder to</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:124pt;left:108pt"><span style="font-family:Times,serif;font-size:9.963pt">learn and use.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:124pt;left:172pt"><span style="font-family:Times,serif;font-size:9.963pt">And contrariwise, it&#x2019;s a royal pain to have interfaces whose</span><i><span style="font-family:Times,serif;font-size:9.963pt"> only</span></i></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:136pt;left:108pt"><span style="font-family:Times,serif;font-size:9.963pt">open, documented form is a program, so you cannot invoke them easily from a C</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:148pt;left:108pt"><span style="font-family:Times,serif;font-size:9.963pt">program &#x2014; for example, route(1) in older Linuxes.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:160pt;left:422pt"><span style="font-family:Times,serif;font-size:9.963pt">&#x2014;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:172pt;left:298pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">&lt;author&gt;HenrySpencer&lt;/author&gt;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:193pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">Besides easing the learning curve, library exercisers often make excellent test frameworks.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:193pt;left:444pt"><span style="font-family:Times,serif;font-size:9.963pt">Expe-</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:205pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">rienced Unix programmers therefore see them not just as a form of thoughtfulness to the library&#x2019;s</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:217pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">users but as an indication that the code has probably been well tested.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:239pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">An important form of library layering is the</span><i><span style="font-family:Times,serif;font-size:9.963pt"> plugin</span></i><span style="font-family:Times,serif;font-size:9.963pt">, a library with a set of known entry points that is</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:251pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">dynamically loaded after startup time to perform a specialized task. For plugins to work, the calling</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:263pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">program has to be organized largely as a documented service library that the plugin can call back</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:275pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">into.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:297pt;left:72pt"><b><span style="font-family:Helvetica,sans-serif;font-size:13.948pt">Case Study: GIMP Plugins</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:324pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The GIMP (GNU Image Manipulation program) is a graphics editor designed to be driven through an</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:336pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">interactive GUI. But GIMP is built as a library of image-manipulation and housekeeping routines</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:348pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">called by a relatively thin layer of control code.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:348pt;left:278pt"><span style="font-family:Times,serif;font-size:9.963pt">The driver code knows about the GUI, but not</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:360pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">directly about image formats; the library routines reverse this by knowing about image formats and</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:372pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">operations but not about the GUI.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:393pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The library layer is documented (and, in fact shipped as &#x201c;libgimp&#x201d; for use by other programs). This</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:405pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">means that C programs called &#x201c;plugins&#x201d; can be dynamically loaded by GIMP and call the library to</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:417pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">do image manipulation, effectively taking over control at the same level as the GUI (see Figure 4.2).</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:262pt"><span style="font-family:Times,serif;font-size:9.963pt">125</span></p>
</div>

<div id="page0" style="position:relative;width:540pt;height:648pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:32pt;left:218pt"><span style="font-family:Times,serif;font-size:9.963pt">Chapter 8. Minilanguages</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:100pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">for the same ends. You can get to a minilanguage design in at least three ways, two of them good</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:112pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">and one of them dangerous.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:134pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">One right way to get there is to realize up front that you can use a minilanguage design to push</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:146pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">a given speci&#xfb01;cation of a programming problem up a level, into a notation that is more compact</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:158pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">and expressive than you could support in a general-purpose language.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:158pt;left:368pt"><span style="font-family:Times,serif;font-size:9.963pt">As with code generation</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:170pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">and data-driven programming, a minilanguage lets you take practical advantage of the fact that the</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:181pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">defect rate in your software will be largely independent of the level of the language you are using;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:193pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">more expressive languages mean shorter programs and fewer bugs.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:215pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The second right way to get to a minilanguage design is to notice that one of your speci&#xfb01;cation &#xfb01;le</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:227pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">formats is looking more and more like a minilanguage &#x2014; that is, it is developing complex structures</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:239pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">and implying actions in the application you are controlling. Is it trying to describe control &#xfb02;ow as</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:251pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">well as data layouts? If so, it may be time to promote that control &#xfb02;ow from being implicit to being</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:263pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">explicit in your speci&#xfb01;cation language.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:285pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">The wrong way to get to a minilanguage design is to extend your way to it, one patch and crufty</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:297pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">added feature at a time. On this path, your speci&#xfb01;cation &#xfb01;le keeps sprouting more implied control</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:309pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">&#xfb02;ow and more tangled special-purpose structures until it has become an ad-hoc language without</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:321pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">your noticing it. Some legendary nightmares have been spawned this way; the example every Unix</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:333pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt">guru will think of (and shudder over) is the</span><tt><span style="font-family:Courier,monospace;font-size:8.966pt"> sendmail.cf</span></tt><span style="font-family:Times,serif;font-size:9.963pt"> con&#xfb01;guration &#xfb01;le associated with the</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:345pt;left:71pt"><i><span style="font-family:Times,serif;font-size:9.963pt">sendmail</span></i><span style="font-family:Times,serif;font-size:9.963pt"> mail transport.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:367pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">Sadly, most people do their &#xfb01;rst minilanguage the wrong way, and only realize later what a mess it</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:379pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">is. Then the question is: how to clean it up? Sometimes the answer implies rethinking the entire</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:391pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">application design. Another notorious example of language-by-feature creep was the editor</span><i><span style="font-family:Times,serif;font-size:9.963pt"> TECO</span></i><span style="font-family:Times,serif;font-size:9.963pt">,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:403pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">which grew &#xfb01;rst macros and then loops and conditionals as programmers wanted to use it to package</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:415pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">increasingly complex editing routines. The resulting ugliness was eventually &#xfb01;xed by a redesign of</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:427pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">the entire editor to be based on an intentional language; this is how Emacs Lisp (which we&#x2019;ll survey</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:439pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">below) evolved.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:460pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">All suf&#xfb01;ciently complicated speci&#xfb01;cation &#xfb01;les aspire to the condition of minilanguages. Therefore,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:472pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">it will often be the case that your only defense against designing a bad minilanguage is knowing</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:484pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">how to design a good one. This need not be a huge step or involve knowing a lot of formal language</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:496pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">theory; with modern tools, learning a few relatively simple techniques and bearing good examples</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:508pt;left:71pt"><span style="font-family:Times,serif;font-size:9.963pt">in mind as you design should be suf&#xfb01;cient.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:262pt"><span style="font-family:Times,serif;font-size:9.963pt">216</span></p>
</div>

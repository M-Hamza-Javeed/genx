<div id="page0" style="position:relative;width:612pt;height:792pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:95pt;left:108pt"><i><span style="font-family:BookAntiqua,serif;font-size:9pt">Working with Events, Sync, and Storage</span></i></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:666pt;left:293pt"><b><span style="font-family:Arial,sans-serif;font-size:9pt">[</span></b><b><span style="font-family:Arial,sans-serif;font-size:8pt"> 102 </span></b><b><span style="font-family:Arial,sans-serif;font-size:9pt">]</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:113pt;left:108pt"><b><span style="font-family:Arial,sans-serif;font-size:20pt">Overriding the Backbone.sync() method</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:137pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Backbone provides a single gateway for all its data communication. All the data </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:150pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">requests are sent via the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">sync()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> method that gets called whenever any </span><span style="font-family:CourierStd,serif;font-size:9.5pt">CRUD</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:162pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">operation is processed. This </span><span style="font-family:CourierStd,serif;font-size:9.5pt">sync()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> method does a number of jobs, such as setting </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:175pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">the URL, parameters and content type, and mimicking HTTP requests for old </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:188pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">browsers that do not support </span><span style="font-family:CourierStd,serif;font-size:9.5pt">PUT</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> and </span><span style="font-family:CourierStd,serif;font-size:9.5pt">DELETE</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> requests. Whenever we call a </span><span style="font-family:CourierStd,serif;font-size:9.5pt">fetch()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:200pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">or </span><span style="font-family:CourierStd,serif;font-size:9.5pt">save()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> method on a model or collection, the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">sync()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> method is executed.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:221pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">But when do we need to override this method? Sometimes, you may need a separate </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:234pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">implementation of the REST API method, which Backbone does not provide. This </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:247pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">can be for a certain model or collection, or the implementation can persist for the </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:259pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">complete project. This is how the method map is written in Backbone by default:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:281pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">var methodMap = {</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:293pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  &apos;create&apos;: &apos;POST&apos;,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:305pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  &apos;update&apos;: &apos;PUT&apos;,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:317pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  &apos;patch&apos;: &apos;PATCH&apos;,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:330pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  &apos;delete&apos;: &apos;DELETE&apos;,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:342pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  &apos;read&apos;: &apos;GET&apos;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:354pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">};</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:373pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Now, you may have a particular model or collection that will listen to a separate </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:386pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">API other than the default one, say the Google or Twitter API, which you cannot </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:399pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">change. Or, you may want to implement an offline storage that will use the browser&apos;s </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:411pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">local storage to operate on the data. In such cases, you need to override the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">sync()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:424pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">method of that collection or model, or if it is common throughout the application, </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:436pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">you need to override the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">Backbone.sync()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> method. Let&apos;s understand its importance </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:449pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">with an example. Here we want our </span><span style="font-family:CourierStd,serif;font-size:9.5pt">User</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> module to interact directly with the public </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:462pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">API </span><span style="font-family:CourierStd,serif;font-size:9.5pt">FooApi</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt">:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:483pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">// FooApi is a public api with &apos;add&apos;, &apos;edit&apos;, &apos;read&apos; </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:495pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">// and &apos;delete&apos; methods</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:507pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">var User = Backbone.Model.extend({</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:520pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  sync: function (method, model, options) {</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:532pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">    options || (options = {});</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:556pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">    switch (method) {</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:569pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">    case &apos;create&apos;:</span></p>
</div>

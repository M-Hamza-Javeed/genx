<div id="page0" style="position:relative;width:540pt;height:648pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:32pt;left:218pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">Chapter 8. Minilanguages</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:96pt;left:72pt"><b><span style="font-family:Helvetica,sans-serif;font-size:13.948pt;color:#ff0000">Case Study:</span></b><b><i><span style="font-family:Helvetica,sans-serif;font-size:13.948pt;color:#ff0000"> awk</span></i></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:122pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">The</span><i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> awk</span></i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> minilanguage is an old-school Unix tool, formerly much used in shellscripts.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:122pt;left:432pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">Like</span><i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> m4</span></i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:134pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">it&#x2019;s intended for writing small but expressive programs to transform textual input into textual output.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:146pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">Versions ship with all Unixes, several in open source; the command</span><b><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> info gawk</span></b><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> at your Unix shell</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:158pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">prompt is quite likely to take you to on-line documentation.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:180pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">Programs in</span><i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> awk</span></i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> consist of pattern/action pairs.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:180pt;left:277pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">Each pattern is a</span><i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> regular expression</span></i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">, a concept</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:192pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">we&#x2019;ll describe in detail in Chapter 9. When an</span><i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> awk</span></i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> program is run, it steps through each line of the</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:204pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">input &#xfb01;le.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:204pt;left:119pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">Each line is checked against every pattern/action pair in order.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:204pt;left:380pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">If the pattern matches</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:216pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">the line, the associated action is performed.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:237pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">Each action is coded in a language resembling a subset of C, with variables and conditionals and</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:249pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">loops and an ontology of types including integers, strings, and (unlike C) dictionaries.</span><sup><span style="font-family:Times,serif;font-size:6.273pt;color:#ff0000">89</span></sup></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:271pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">The</span><i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> awk</span></i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> action language is Turing-complete, and can read and write &#xfb01;les. In some versions it can</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:283pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">open and use network sockets. But</span><i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> awk</span></i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> has primarily seen use as a report generator, especially for</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:295pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">interpreting and reducing tabular data. It is seldom used standalone, but rather embedded in scripts.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:307pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">There is an example</span><i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> awk</span></i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> program in the case study on HTML generation included in Chapter 9.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:329pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">A case study of</span><i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> awk</span></i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> is included to point out that it is</span><i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> not</span></i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> a model for emulation; in fact, since 1990</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:341pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">it has largely fallen out of use. It has been superseded by new-school scripting languages&#x2014;notably</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:353pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">Perl, which was explicitly designed to be an</span><i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> awk</span></i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> killer.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:353pt;left:306pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">The reasons are worthy of examination,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:365pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">because they constitute a bit of a cautionary tale for minilanguage designers.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:387pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">The</span><i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> awk</span></i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> language was originally designed to be a small, expressive special-purpose language for</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:399pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">report generation. Unfortunately, it turns out to have been designed at a bad spot on the complexity-</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:411pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">vs.-power curve. The action language is noncompact, but the pattern-driven framework it sits inside</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:423pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">keeps it from being generally applicable &#x2014; that&#x2019;s the worst of both worlds.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:423pt;left:386pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">And the new-school</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:435pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">scripting languages can do anything</span><i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> awk</span></i><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000"> can; their equivalent programs are usually just as readable,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:447pt;left:72pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">if not more so.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:469pt;left:108pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">Awk has also fallen out of use because more modern shells have &#xfb02;oating point</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:481pt;left:108pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">arithmetic, associative arrays, RE pattern matching, and substring capabilities, so</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:500pt;left:72pt"><span style="font-family:Times,serif;font-size:5.018pt">89</span><span style="font-family:Times,serif;font-size:7.97pt">For those who have never programmed in a modern scripting language, a dictionary is a lookup table of key-to-value</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:510pt;left:72pt"><span style="font-family:Times,serif;font-size:7.97pt">associations, often implemented through a hash table.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:510pt;left:258pt"><span style="font-family:Times,serif;font-size:7.97pt">C programmers spend a lot of their coding time implementing</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:519pt;left:72pt"><span style="font-family:Times,serif;font-size:7.97pt">dictionaries in various elaborate ways.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:581pt;left:262pt"><span style="font-family:Times,serif;font-size:9.963pt;color:#ff0000">236</span></p>
</div>

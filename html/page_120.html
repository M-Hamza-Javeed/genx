<div id="page0" style="position:relative;width:612pt;height:792pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:95pt;left:108pt"><i><span style="font-family:BookAntiqua,serif;font-size:9pt">Working with Events, Sync, and Storage</span></i></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:666pt;left:293pt"><b><span style="font-family:Arial,sans-serif;font-size:9pt">[</span></b><b><span style="font-family:Arial,sans-serif;font-size:8pt"> 104 </span></b><b><span style="font-family:Arial,sans-serif;font-size:9pt">]</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:113pt;left:108pt"><b><span style="font-family:Arial,sans-serif;font-size:20pt">Offline storage using the </span></b><b><span style="font-family:Arial,sans-serif;font-size:20pt"> </span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:137pt;left:108pt"><b><span style="font-family:Arial,sans-serif;font-size:20pt">Backbone.LocalStorage adapter</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:161pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">In the previous section, we saw how overriding the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">Backbone.sync()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> method </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:174pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">provides you with customized data operations, including models and collections. </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:186pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Most of the time, we use the HTML5 </span><span style="font-family:CourierStd,serif;font-size:9.5pt">LocalStorage</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> functionality to store our </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:199pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">data in the browser for offline browsing. This is a pretty common requirement for </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:212pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">storing small data in a browser while developing mobile websites and mobile web </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:224pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">applications. The </span><span style="font-family:CourierStd,serif;font-size:9.5pt">LocalStorage</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> communication can also be done with the help of </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:237pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">sync()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> method in a way that is exactly the same as the technique used in the </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:249pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">previous section by overriding the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">sync()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> method.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:271pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Rather than creating this solution ourselves, we will look into an excellent adapter, </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:283pt;left:108pt"><span style="font-family:CourierStd,serif;font-size:9.5pt">Backbone.LocalStorage</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> (</span><span style="font-family:CourierStd,serif;font-size:9.5pt">http://documentup.com/jeromegn/backbone.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:296pt;left:108pt"><span style="font-family:CourierStd,serif;font-size:9.5pt">localStorage</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt">), which was developed by Jerome Gravel-Niquet and widely used </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:308pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">by the Backbone.js developer community for interacting with </span><span style="font-family:CourierStd,serif;font-size:9.5pt">LocalStorage</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt">. This </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:321pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">adapter can be plugged into any model or collection, and thus enables them to </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:334pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">communicate with </span><span style="font-family:CourierStd,serif;font-size:9.5pt">LocalStorage</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> using the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">save()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> or </span><span style="font-family:CourierStd,serif;font-size:9.5pt">fetch()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> methods as follows:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:355pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">var Users = Backbone.Collection.extend({</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:367pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  model: Backbone.Model,</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:380pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  localStorage: new Backbone.LocalStorage(&quot;users&quot;)</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:392pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">});</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:416pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">var users = new Users();</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:441pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">// Add items to collection</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:453pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">users.add([{</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:465pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  name: &apos;Soumendu De&apos;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:477pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">}, {</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:490pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  name: &apos;Bikash Debroy&apos;</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:502pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">}])</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:526pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">// Sync collection data to localstorage</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:539pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">users.each(function (user) {</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:551pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  user.save();</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:563pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">}); </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:582pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Here we</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> defined a collection by passing an instance of </span><span style="font-family:CourierStd,serif;font-size:9.5pt">Backbone.LocalStorage</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> to </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:595pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">LocalStorage</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> property. </span><span style="font-family:BookAntiqua,serif;font-size:10.5pt">This is the only configuration that is requires to attach </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:608pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">the collection to </span><span style="font-family:CourierStd,serif;font-size:9.5pt">LocalStorage</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> and perform all of the data operations on it. Also, this </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:620pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">configuration works for both the model and the collection. If you want to know how </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:633pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">sync()</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> functionality has been implemented within this adapter, go ahead and </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:645pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">look into the adapter code&#x2014;it&apos;s small and pretty well-written.</span></p>
</div>

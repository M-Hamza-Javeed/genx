<div id="page0" style="position:relative;width:612pt;height:792pt;background-color:white">
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:95pt;left:468pt"><i><span style="font-family:BookAntiqua,serif;font-size:9pt">Chapter 6</span></i></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:666pt;left:295pt"><b><span style="font-family:Arial,sans-serif;font-size:9pt">[</span></b><b><span style="font-family:Arial,sans-serif;font-size:8pt"> 99 </span></b><b><span style="font-family:Arial,sans-serif;font-size:9pt">]</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:115pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">  console.log(&apos;Custom event fired&apos;);</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:127pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">});</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:152pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">// Fire the event</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:164pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">vent.trigger(&apos;customevent&apos;);</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:183pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">When we make the </span><span style="font-family:CourierStd,serif;font-size:9.5pt">vent</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> variable available at the application-level, it can work  </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:196pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">as a centralized event dispatcher to publish and subscribe to events. This pattern is </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:208pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">called PubSub pattern and is quite beneficial for use in a module- or widget-based </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:221pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">application architecture.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:250pt;left:178pt"><span style="font-family:BookAntiqua,serif;font-size:9.5pt">You should understand the context where this will be a good choice. </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:261pt;left:178pt"><span style="font-family:BookAntiqua,serif;font-size:9.5pt">An event dispatcher should be used when you either have too many </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:273pt;left:178pt"><span style="font-family:BookAntiqua,serif;font-size:9.5pt">components to listen to (as we saw in the case of the login example) </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:284pt;left:178pt"><span style="font-family:BookAntiqua,serif;font-size:9.5pt">or when you have some completely unrelated objects that need to </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:296pt;left:178pt"><span style="font-family:BookAntiqua,serif;font-size:9.5pt">communicate with each other.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:321pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">The main problem that you may face while working with a common event </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:333pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">dispatcher is that the number of publishers and subscribers may get out of control </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:346pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">when too many events are registered through a single event dispatcher. For example, </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:358pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">say we have two modules, </span><span style="font-family:CourierStd,serif;font-size:9.5pt">User</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> and </span><span style="font-family:CourierStd,serif;font-size:9.5pt">Company</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt">, and both the modules are subscribed </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:371pt;left:107pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">to an event named </span><span style="font-family:CourierStd,serif;font-size:9.5pt">addcomment</span><span style="font-family:BookAntiqua,serif;font-size:10.5pt"> on the event dispatcher separately; they are defined </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:384pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">as follows:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:405pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">vent.on(&apos;addcomment&apos;, user.addComment);</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:417pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">vent.on(&apos;addcomment&apos;, company.addComment);</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:437pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Notice that the event name is the same, but the functions to be called are different. </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:449pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">So, if you want another subscriber to be notified for the same event, you need to clear </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:462pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">up all the other subscribers of that event first and then publish the event. However, </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:474pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">there are a few other simple solutions to this issue, such as creating multiple event </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:487pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">dispatchers or using different event namespaces.</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:518pt;left:108pt"><b><span style="font-family:Arial,sans-serif;font-size:18pt">Creating multiple event dispatchers</span></b></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:540pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Defining a </span><span style="font-family:BookAntiqua,serif;font-size:10.5pt">separate event dispatcher for individual modules or functionality can </span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:552pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">provide a solution to the problem we described previously:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:574pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">App.userVent = _.extend({}, Backbone.Events);</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:586pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">App.documentVent = extend({}, Backbone.Events);</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:605pt;left:108pt"><span style="font-family:BookAntiqua,serif;font-size:10.5pt">Now, the same event names for different dispatchers will never clash:</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:627pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">App.userVent.on(&apos;addcomment&apos;, user.addComment);</span></p>
<p style="position:absolute;white-space:pre;margin:0;padding:0;top:639pt;left:126pt"><span style="font-family:CourierStd,serif;font-size:9pt">App.documentVent.on(&apos;addcomment&apos;, company.addComment);</span></p>
</div>
